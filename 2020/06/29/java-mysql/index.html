<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>MySQL | Uncle He</title><meta name="description" content="MySQL的使用启动和停止服务关系型数据库分为桌面文件共享型数据库，例如Access，和C&#x2F;S架构的网络共享型数据库，例如：MySQL，Oracle等。MySQL软件的服务器端必须先启动，客户端才可以连接和使用使用数据库。 图形化方式Windows：  “我的电脑&#x2F;计算机”–&gt;右键–&gt;“管理”–&gt;“服务”–&gt;启动和关闭MySQL  “开始菜单”–&gt;“控制面板”–&amp;gt"><meta name="keywords" content="MySQL"><meta name="author" content="Uncle He"><meta name="copyright" content="Uncle He"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="MySQL"><meta name="twitter:description" content="MySQL的使用启动和停止服务关系型数据库分为桌面文件共享型数据库，例如Access，和C&#x2F;S架构的网络共享型数据库，例如：MySQL，Oracle等。MySQL软件的服务器端必须先启动，客户端才可以连接和使用使用数据库。 图形化方式Windows：  “我的电脑&#x2F;计算机”–&gt;右键–&gt;“管理”–&gt;“服务”–&gt;启动和关闭MySQL  “开始菜单”–&gt;“控制面板”–&amp;gt"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/cover/mysql.jpeg"><meta property="og:type" content="article"><meta property="og:title" content="MySQL"><meta property="og:url" content="https://www.unclehe.net/2020/06/29/java-mysql/"><meta property="og:site_name" content="Uncle He"><meta property="og:description" content="MySQL的使用启动和停止服务关系型数据库分为桌面文件共享型数据库，例如Access，和C&#x2F;S架构的网络共享型数据库，例如：MySQL，Oracle等。MySQL软件的服务器端必须先启动，客户端才可以连接和使用使用数据库。 图形化方式Windows：  “我的电脑&#x2F;计算机”–&gt;右键–&gt;“管理”–&gt;“服务”–&gt;启动和关闭MySQL  “开始菜单”–&gt;“控制面板”–&amp;gt"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/cover/mysql.jpeg"><meta property="article:published_time" content="2020-06-29T06:54:50.000Z"><meta property="article:modified_time" content="2020-07-08T06:46:36.564Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = 'false'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="https://www.unclehe.net/2020/06/29/java-mysql/"><link rel="prev" title="JDBC" href="https://www.unclehe.net/2020/07/03/java-jdbc/"><link rel="next" title="设计模式" href="https://www.unclehe.net/2020/06/28/java-design-pattern/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"cookieDomain":"https://unclehe.net/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: Uncle He","link":"链接: ","source":"来源: Uncle He","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: true,
  fancybox: false,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"top-right"},
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'true',
  isFontAwesomeV5: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/css/customcss.css"><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">29</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">15</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">17</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="https://unclehe.gitee.io" target="_blank" rel="noopener"><i class="fa-fw fa fa-toolbox"></i><span> 百宝箱</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> 留言板</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL的使用"><span class="toc-number">1.</span> <span class="toc-text">MySQL的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#启动和停止服务"><span class="toc-number">1.1.</span> <span class="toc-text">启动和停止服务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#图形化方式"><span class="toc-number">1.1.1.</span> <span class="toc-text">图形化方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#命令行"><span class="toc-number">1.1.2.</span> <span class="toc-text">命令行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#客户端命令行登录"><span class="toc-number">1.2.</span> <span class="toc-text">客户端命令行登录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#获取MySQL版本"><span class="toc-number">1.3.</span> <span class="toc-text">获取MySQL版本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#导入和导出数据"><span class="toc-number">1.4.</span> <span class="toc-text">导入和导出数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#单个数据库备份"><span class="toc-number">1.4.1.</span> <span class="toc-text">单个数据库备份</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#导入执行备份的sql脚本"><span class="toc-number">1.4.2.</span> <span class="toc-text">导入执行备份的sql脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mysql的逻辑架构与存储引擎"><span class="toc-number">2.</span> <span class="toc-text">Mysql的逻辑架构与存储引擎</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL的逻辑架构"><span class="toc-number">2.1.</span> <span class="toc-text">MySQL的逻辑架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#逻辑架构"><span class="toc-number">2.2.</span> <span class="toc-text">逻辑架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查看存储引擎"><span class="toc-number">2.3.</span> <span class="toc-text">查看存储引擎</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#简单的SQL示例"><span class="toc-number">3.</span> <span class="toc-text">简单的SQL示例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#示例小demo"><span class="toc-number">3.1.</span> <span class="toc-text">示例小demo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#错误ERROR-：没有选择数据库就操作表格和数据"><span class="toc-number">3.2.</span> <span class="toc-text">错误ERROR ：没有选择数据库就操作表格和数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#命令行客户端的字符集问题"><span class="toc-number">3.3.</span> <span class="toc-text">命令行客户端的字符集问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查看字符集和校对规则"><span class="toc-number">3.4.</span> <span class="toc-text">查看字符集和校对规则</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#查看所有字符集和校对规则"><span class="toc-number">3.4.1.</span> <span class="toc-text">查看所有字符集和校对规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看GBK和UTF-8字符集的校对规则"><span class="toc-number">3.4.2.</span> <span class="toc-text">查看GBK和UTF-8字符集的校对规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看服务器的字符集和校对规则"><span class="toc-number">3.4.3.</span> <span class="toc-text">查看服务器的字符集和校对规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看和修改某个数据库的字符集和校对规则"><span class="toc-number">3.4.4.</span> <span class="toc-text">查看和修改某个数据库的字符集和校对规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看某个表格的字符集和校对规则"><span class="toc-number">3.4.5.</span> <span class="toc-text">查看某个表格的字符集和校对规则</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL的数据类型"><span class="toc-number">4.</span> <span class="toc-text">MySQL的数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#整数（xxxint）"><span class="toc-number">4.1.</span> <span class="toc-text">整数（xxxint）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#浮点型"><span class="toc-number">4.2.</span> <span class="toc-text">浮点型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#定点型"><span class="toc-number">4.3.</span> <span class="toc-text">定点型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#日期时间类型"><span class="toc-number">4.4.</span> <span class="toc-text">日期时间类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#字符串型"><span class="toc-number">4.5.</span> <span class="toc-text">字符串型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#char-varchar-text区别"><span class="toc-number">4.5.1.</span> <span class="toc-text">char,varchar,text区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#哪些情况使用char或varchar更好"><span class="toc-number">4.5.2.</span> <span class="toc-text">哪些情况使用char或varchar更好</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#位类型"><span class="toc-number">4.6.</span> <span class="toc-text">位类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二进制值类型"><span class="toc-number">4.7.</span> <span class="toc-text">二进制值类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#枚举（ENUM）"><span class="toc-number">4.8.</span> <span class="toc-text">枚举（ENUM）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#集合（SET）"><span class="toc-number">4.9.</span> <span class="toc-text">集合（SET）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#特殊的NULL值"><span class="toc-number">4.10.</span> <span class="toc-text">特殊的NULL值</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL"><span class="toc-number">5.</span> <span class="toc-text">SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL的语言规范"><span class="toc-number">5.1.</span> <span class="toc-text">SQL的语言规范</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL分类"><span class="toc-number">5.2.</span> <span class="toc-text">SQL分类</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DDL"><span class="toc-number">6.</span> <span class="toc-text">DDL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#操作Database"><span class="toc-number">6.1.</span> <span class="toc-text">操作Database</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建数据库"><span class="toc-number">6.1.1.</span> <span class="toc-text">创建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看有哪些数据库"><span class="toc-number">6.1.2.</span> <span class="toc-text">查看有哪些数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除数据库"><span class="toc-number">6.1.3.</span> <span class="toc-text">删除数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#选择数据库"><span class="toc-number">6.1.4.</span> <span class="toc-text">选择数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看当前正在使用哪个数据库"><span class="toc-number">6.1.5.</span> <span class="toc-text">查看当前正在使用哪个数据库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#表结构的操作TABLE"><span class="toc-number">6.2.</span> <span class="toc-text">表结构的操作TABLE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#查看当前数据库的所有表格"><span class="toc-number">6.2.1.</span> <span class="toc-text">查看当前数据库的所有表格</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建表结构"><span class="toc-number">6.2.2.</span> <span class="toc-text">创建表结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#基础版"><span class="toc-number">6.2.2.1.</span> <span class="toc-text">基础版</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#详细版"><span class="toc-number">6.2.2.2.</span> <span class="toc-text">详细版</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看表结构"><span class="toc-number">6.2.3.</span> <span class="toc-text">查看表结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除表结构"><span class="toc-number">6.2.4.</span> <span class="toc-text">删除表结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改表结构"><span class="toc-number">6.2.5.</span> <span class="toc-text">修改表结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#重命名表"><span class="toc-number">6.2.5.1.</span> <span class="toc-text">重命名表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#增加一列"><span class="toc-number">6.2.5.2.</span> <span class="toc-text">增加一列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#删除列"><span class="toc-number">6.2.5.3.</span> <span class="toc-text">删除列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#修改列类型"><span class="toc-number">6.2.5.4.</span> <span class="toc-text">修改列类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#修改列名等"><span class="toc-number">6.2.5.5.</span> <span class="toc-text">修改列名等</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#约束：CONSTRAINTS"><span class="toc-number">6.2.6.</span> <span class="toc-text">约束：CONSTRAINTS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#查看某个表的约束和索引"><span class="toc-number">6.2.6.1.</span> <span class="toc-text">查看某个表的约束和索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#主键约束PRIMARY-KEY"><span class="toc-number">6.2.6.2.</span> <span class="toc-text">主键约束PRIMARY KEY</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#唯一键Unique-key，简称UK"><span class="toc-number">6.2.6.3.</span> <span class="toc-text">唯一键Unique key，简称UK</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#外键：Foreign-key，简称FK"><span class="toc-number">6.2.6.4.</span> <span class="toc-text">外键：Foreign key，简称FK</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#非空约束"><span class="toc-number">6.2.6.5.</span> <span class="toc-text">非空约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#检查约束"><span class="toc-number">6.2.6.6.</span> <span class="toc-text">检查约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Default缺省约束"><span class="toc-number">6.2.6.7.</span> <span class="toc-text">Default缺省约束</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#索引：INDEX"><span class="toc-number">6.2.7.</span> <span class="toc-text">索引：INDEX</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自增列：AUTO-INCREMENT"><span class="toc-number">6.2.8.</span> <span class="toc-text">自增列：AUTO_INCREMENT</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DML"><span class="toc-number">7.</span> <span class="toc-text">DML</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#插入数据"><span class="toc-number">7.1.</span> <span class="toc-text">插入数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#语法"><span class="toc-number">7.1.1.</span> <span class="toc-text">语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#说明"><span class="toc-number">7.1.2.</span> <span class="toc-text">说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#示例"><span class="toc-number">7.1.3.</span> <span class="toc-text">示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改数据"><span class="toc-number">7.2.</span> <span class="toc-text">修改数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#语法-1"><span class="toc-number">7.2.1.</span> <span class="toc-text">语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#说明-1"><span class="toc-number">7.2.2.</span> <span class="toc-text">说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#示例-1"><span class="toc-number">7.2.3.</span> <span class="toc-text">示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#删除数据"><span class="toc-number">7.3.</span> <span class="toc-text">删除数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#语法-2"><span class="toc-number">7.3.1.</span> <span class="toc-text">语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#说明-2"><span class="toc-number">7.3.2.</span> <span class="toc-text">说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#示例-2"><span class="toc-number">7.3.3.</span> <span class="toc-text">示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#查询"><span class="toc-number">7.4.</span> <span class="toc-text">查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#语法-3"><span class="toc-number">7.4.1.</span> <span class="toc-text">语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#别名AS"><span class="toc-number">7.4.2.</span> <span class="toc-text">别名AS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#去重DISTINCT"><span class="toc-number">7.4.3.</span> <span class="toc-text">去重DISTINCT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#着重号"><span class="toc-number">7.4.4.</span> <span class="toc-text">&#96;着重号&#96;</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL的运算符"><span class="toc-number">8.</span> <span class="toc-text">MySQL的运算符</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#算术运算符"><span class="toc-number">8.1.</span> <span class="toc-text">算术运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#比较运算符"><span class="toc-number">8.2.</span> <span class="toc-text">比较运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#逻辑运算符"><span class="toc-number">8.3.</span> <span class="toc-text">逻辑运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#范围和集合"><span class="toc-number">8.4.</span> <span class="toc-text">范围和集合</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#模糊查询"><span class="toc-number">8.5.</span> <span class="toc-text">模糊查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NULL值判断与计算处理"><span class="toc-number">8.6.</span> <span class="toc-text">NULL值判断与计算处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#位运算符"><span class="toc-number">8.7.</span> <span class="toc-text">位运算符</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#关联查询，联合查询"><span class="toc-number">9.</span> <span class="toc-text">关联查询，联合查询</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#笛卡尔积"><span class="toc-number">9.1.</span> <span class="toc-text">笛卡尔积</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#关联条件"><span class="toc-number">9.2.</span> <span class="toc-text">关联条件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#内连接（INNER-JOIN）"><span class="toc-number">9.3.</span> <span class="toc-text">内连接（INNER JOIN）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#外连接（OUTER-JOIN）"><span class="toc-number">9.4.</span> <span class="toc-text">外连接（OUTER  JOIN）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#左连接（LEFT-JOIN）"><span class="toc-number">9.4.1.</span> <span class="toc-text">左连接（LEFT JOIN）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#右外连接（RIGHT-JOIN）"><span class="toc-number">9.4.2.</span> <span class="toc-text">右外连接（RIGHT JOIN）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#外连接（FULL-JOIN）"><span class="toc-number">9.4.3.</span> <span class="toc-text">外连接（FULL JOIN）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自连接"><span class="toc-number">9.5.</span> <span class="toc-text">自连接</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#select的6个子句"><span class="toc-number">10.</span> <span class="toc-text">select的6个子句</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#from"><span class="toc-number">10.1.</span> <span class="toc-text">from</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#where条件查询"><span class="toc-number">10.2.</span> <span class="toc-text">where条件查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#group-by-分组查询"><span class="toc-number">10.3.</span> <span class="toc-text">group by 分组查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#聚合函数"><span class="toc-number">10.3.1.</span> <span class="toc-text">聚合函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#group-by-聚合函数"><span class="toc-number">10.3.2.</span> <span class="toc-text">group by + 聚合函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#having-筛选"><span class="toc-number">10.4.</span> <span class="toc-text">having 筛选</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#order-by-排序"><span class="toc-number">10.5.</span> <span class="toc-text">order by 排序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#limit-分页"><span class="toc-number">10.6.</span> <span class="toc-text">limit 分页</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#子查询"><span class="toc-number">11.</span> <span class="toc-text">子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#where型子查询"><span class="toc-number">11.1.</span> <span class="toc-text">where型子查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#from型子查询"><span class="toc-number">11.2.</span> <span class="toc-text">from型子查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exists型子查询"><span class="toc-number">11.3.</span> <span class="toc-text">exists型子查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#复制表子查询"><span class="toc-number">11.4.</span> <span class="toc-text">复制表子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#复制表"><span class="toc-number">11.4.1.</span> <span class="toc-text">复制表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#复制数据"><span class="toc-number">11.4.2.</span> <span class="toc-text">复制数据</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#单行函数"><span class="toc-number">12.</span> <span class="toc-text">单行函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#数学函数"><span class="toc-number">12.1.</span> <span class="toc-text">数学函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#字符串函数"><span class="toc-number">12.2.</span> <span class="toc-text">字符串函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#日期时间函数"><span class="toc-number">12.3.</span> <span class="toc-text">日期时间函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#流程函数"><span class="toc-number">12.4.</span> <span class="toc-text">流程函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#其他函数"><span class="toc-number">12.5.</span> <span class="toc-text">其他函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#事务"><span class="toc-number">13.</span> <span class="toc-text">事务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#事务的ACID特性"><span class="toc-number">13.1.</span> <span class="toc-text">事务的ACID特性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#事务的用法"><span class="toc-number">13.2.</span> <span class="toc-text">事务的用法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据库的隔离级别"><span class="toc-number">13.3.</span> <span class="toc-text">数据库的隔离级别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#示例演示"><span class="toc-number">13.4.</span> <span class="toc-text">示例演示</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#脏读"><span class="toc-number">13.4.1.</span> <span class="toc-text">脏读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#不可重复读"><span class="toc-number">13.4.2.</span> <span class="toc-text">不可重复读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#幻读"><span class="toc-number">13.4.3.</span> <span class="toc-text">幻读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#序列化"><span class="toc-number">13.4.4.</span> <span class="toc-text">序列化</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#权限与安全"><span class="toc-number">14.</span> <span class="toc-text">权限与安全</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#权限系统的工作原理"><span class="toc-number">14.1.</span> <span class="toc-text">权限系统的工作原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#身份认证"><span class="toc-number">14.1.1.</span> <span class="toc-text">身份认证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#权限表的存取"><span class="toc-number">14.1.2.</span> <span class="toc-text">权限表的存取</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#用户表user"><span class="toc-number">14.1.2.1.</span> <span class="toc-text">用户表user</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#账号管理"><span class="toc-number">14.2.</span> <span class="toc-text">账号管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建或更改账号"><span class="toc-number">14.2.1.</span> <span class="toc-text">创建或更改账号</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#语句命令方式"><span class="toc-number">14.2.1.1.</span> <span class="toc-text">语句命令方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#navicat图形化界面"><span class="toc-number">14.2.1.2.</span> <span class="toc-text">navicat图形化界面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQLyog图形化界面"><span class="toc-number">14.2.1.3.</span> <span class="toc-text">SQLyog图形化界面</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查看账户权限"><span class="toc-number">14.2.2.</span> <span class="toc-text">查看账户权限</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#删除用户"><span class="toc-number">14.2.3.</span> <span class="toc-text">删除用户</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#经典问题"><span class="toc-number">15.</span> <span class="toc-text">经典问题</span></a></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/cover/mysql.jpeg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Uncle He</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="https://unclehe.gitee.io" target="_blank" rel="noopener"><i class="fa-fw fa fa-toolbox"></i><span> 百宝箱</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> 留言板</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">MySQL</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-06-29 14:54:50"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-06-29</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-07-08 14:46:36"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-07-08</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E8%87%AA%E5%AD%A6Java/">自学Java</a><i class="fa fa-angle-right post-meta__separator" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E8%87%AA%E5%AD%A6Java/MySQL/">MySQL</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon far fa-file-word" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">23.3k</span><span class="post-meta__separator">|</span><i class="post-meta__icon far fa-clock" aria-hidden="true"></i><span>阅读时长: 85 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="post-meta__icon far fa-comments" aria-hidden="true"></i><span>评论数:</span><a href="/2020/06/29/java-mysql/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2020/06/29/java-mysql/" itemprop="commentCount"></span></a></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="MySQL的使用"><a href="#MySQL的使用" class="headerlink" title="MySQL的使用"></a>MySQL的使用</h1><h2 id="启动和停止服务"><a href="#启动和停止服务" class="headerlink" title="启动和停止服务"></a>启动和停止服务</h2><p>关系型数据库分为桌面文件共享型数据库，例如Access，和C/S架构的网络共享型数据库，例如：MySQL，Oracle等。MySQL软件的服务器端必须先启动，客户端才可以连接和使用使用数据库。</p>
<h3 id="图形化方式"><a href="#图形化方式" class="headerlink" title="图形化方式"></a>图形化方式</h3><p>Windows：</p>
<ul>
<li><p>“我的电脑/计算机”–&gt;右键–&gt;“管理”–&gt;“服务”–&gt;启动和关闭MySQL</p>
</li>
<li><p>“开始菜单”–&gt;“控制面板”–&gt;“管理工具”–&gt;“服务”–&gt;启动和关闭MySQL</p>
</li>
<li><p>“任务管理器”–&gt;“服务”–&gt;启动和关闭MySQL</p>
</li>
</ul>
<p>Mac：</p>
<ul>
<li>打开MySQL软件，进行启动和关闭</li>
</ul>
<h3 id="命令行"><a href="#命令行" class="headerlink" title="命令行"></a>命令行</h3><p>Windows：</p>
<ul>
<li>net  start  MySQL服务名</li>
<li>net  stop  MySQL服务名</li>
</ul>
<p>Mac：</p>
<ul>
<li>mysql.server start    启动MySQL</li>
<li>mysql.server stop    关闭MySQL</li>
<li>mysql.server status    查看MySQL状态</li>
</ul>
<h2 id="客户端命令行登录"><a href="#客户端命令行登录" class="headerlink" title="客户端命令行登录"></a>客户端命令行登录</h2><blockquote>
<p>mysql -h 主机名 -P 端口号 -u 用户名 -p密码</p>
</blockquote>
<p>例如：mysql -h localhost -P 3306 -u root -proot</p>
<p><strong>注意：</strong></p>
<ol>
<li><p>-p与密码之间不能有空格，其他参数名与参数值之间可以有空格也可以没有空格</p>
<p>mysql -hlocalhost -P3306 -uroot -proot</p>
</li>
<li><p>密码建议在下一行输入</p>
<p>mysql -h localhost -P 3306 -u root -p</p>
<p>Enter password:</p>
</li>
<li><p>如果是连本机：-hlocalhost就可以省略，如果端口号没有修改：-P3306也可以省略</p>
<p>简写成：mysql -u root -p</p>
<p>Enter password:</p>
</li>
</ol>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql1.png" alt="mysql"></p>
<h2 id="获取MySQL版本"><a href="#获取MySQL版本" class="headerlink" title="获取MySQL版本"></a>获取MySQL版本</h2><ol>
<li><p>登录成功后，有关于MySQL Server服务版本的信息，还有第几次连接的id标识。</p>
</li>
<li><p>或<strong>登录</strong>后，通过以下方式查看当前版本信息：</p>
</li>
</ol>
<ul>
<li>SELECT VERSION();</li>
</ul>
<ol start="3">
<li>也可以在命令行通过以下方式获取MySQL Server服务版本的信息</li>
</ol>
<ul>
<li>mysql –version    获取MySQL版本信息</li>
</ul>
<h2 id="导入和导出数据"><a href="#导入和导出数据" class="headerlink" title="导入和导出数据"></a>导入和导出数据</h2><h3 id="单个数据库备份"><a href="#单个数据库备份" class="headerlink" title="单个数据库备份"></a>单个数据库备份</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">C:\Windows\System32&gt; mysqldump -h主机地址 -P端口号 -u用户名 -p密码 --database 数据名 &gt; 文件路径&#x2F;文件名.sql</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">C:\Windows\System32&gt;mysqldump -hlocalhost -P3306 -uroot -p123456 --database test &gt; d:&#x2F;test.sql</span><br></pre></td></tr></table></figure>



<h3 id="导入执行备份的sql脚本"><a href="#导入执行备份的sql脚本" class="headerlink" title="导入执行备份的sql脚本"></a>导入执行备份的sql脚本</h3><p>先登录mysql，然后执行如下命令：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; source  sql脚本路径名.sql</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt;source d:&#x2F;test.sql;</span><br></pre></td></tr></table></figure>



<h1 id="Mysql的逻辑架构与存储引擎"><a href="#Mysql的逻辑架构与存储引擎" class="headerlink" title="Mysql的逻辑架构与存储引擎"></a>Mysql的逻辑架构与存储引擎</h1><h2 id="MySQL的逻辑架构"><a href="#MySQL的逻辑架构" class="headerlink" title="MySQL的逻辑架构"></a>MySQL的逻辑架构</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql2.png" alt="mysql"></p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql3.png" alt="mysql"></p>
<h2 id="逻辑架构"><a href="#逻辑架构" class="headerlink" title="逻辑架构"></a>逻辑架构</h2><p>MySQL最重要、最与众不同的特性是它的<strong>存储引擎架构</strong>，这种架构的设计将查询处理（Query Processing）及其他系统任务（Server Task）和数据的存储/提取相分离。这种处理和存储分离的设计可以在使用时根据性能、特性，以及其他需求来选择数据存储的方式。</p>
<p>MySQL中同一个数据库，不同的表格可以选择不同的存储引擎。</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql4.png" alt="mysql"></p>
<ul>
<li>MyISAM不支持事务、也不支持外键，其优势是访问的速度快，对事务完整性没有要求或者以SELECT、INSERT为主的应用。每个MyISAM在磁盘上存储成三个文件。第一个文件的名字以表的名字开始，扩展名指出文件类型。.frm文件存储表定义。数据文件的扩展名为.MYD (MYData)。索引文件的扩展名是.MYI (MYIndex)。</li>
<li>InnoDB存储引擎提供了具有提交、回滚和崩溃恢复能力的事务安全。但是对比MyISAM的存储引擎，InnoDB写的处理效率差一些，并且会占用更多的磁盘空间以保存数据和索引。InnoDB：所有的表都保存在同一个数据文件中，InnoDB表的大小只受限于操作系统文件的大小限制。Myisam只缓存索引，不缓存真实数据；Innodb不仅缓存索引还要缓存真实数据，对内存要求较高，而且内存大小对性能有决定性的影响。</li>
<li>MEMORY存储引擎使用存在于内存中的内容来创建表。MEMORY类型的表访问非常的快，因为它的数据是放在内存中的，并且默认使用HASH索引，但是一旦服务关闭，表中的数据就会丢失。主要用于那些内容变化不频繁的代码表或者作为统计操作的中间结果表。</li>
</ul>
<h2 id="查看存储引擎"><a href="#查看存储引擎" class="headerlink" title="查看存储引擎"></a>查看存储引擎</h2><ul>
<li>SHOW ENGINES;     查看当前mysql数据库管理软件支持的存储引擎</li>
</ul>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql5.png" alt="mysql"></p>
<ul>
<li>SHOW VARIABLES LIKE ‘%storage_engine%’;    查看默认存储引擎和当前选择的存储引擎</li>
</ul>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql6.png" alt="mysql"></p>
<p>创建新表时如果不指定存储引擎，那么系统就会使用默认存储引擎，MySQL5.5之前的默认存储引擎是MyISAM，5.5之后改为了InnoDB。</p>
<ul>
<li>SHOW CREATE TABLE 表名称;    查看已经创建的表格的存储引擎</li>
</ul>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql7.png" alt="mysql"></p>
<h1 id="简单的SQL示例"><a href="#简单的SQL示例" class="headerlink" title="简单的SQL示例"></a>简单的SQL示例</h1><h2 id="示例小demo"><a href="#示例小demo" class="headerlink" title="示例小demo"></a>示例小demo</h2><p>查看当前的MySQL服务器中有哪些数据库</p>
<ul>
<li>SHOW DATABASES;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; SHOW DATABASES;</span><br><span class="line"></span><br><span class="line">+--------------------+</span><br><span class="line"></span><br><span class="line">| Database      |</span><br><span class="line"></span><br><span class="line">+--------------------+</span><br><span class="line"></span><br><span class="line">| information_schema |</span><br><span class="line"></span><br><span class="line">| mysql        |</span><br><span class="line"></span><br><span class="line">| performance_schema |</span><br><span class="line"></span><br><span class="line">| test        |</span><br><span class="line"></span><br><span class="line">+--------------------+</span><br><span class="line"></span><br><span class="line">4 rows in set (0.05 sec)</span><br></pre></td></tr></table></figure>

<p>使用test数据库</p>
<ul>
<li>USE 数据库名;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; USE test;</span><br><span class="line">Database changed</span><br></pre></td></tr></table></figure>

<p>创建表</p>
<ul>
<li>CREATE TABLE 表名(列…);</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; CREATE TABLE t_stu(</span><br><span class="line">    -&gt;  sid INT,</span><br><span class="line">    -&gt;  sname VARCHAR(100),</span><br><span class="line">    -&gt;  gender CHAR</span><br><span class="line">    -&gt; );</span><br><span class="line">Query OK, 0 rows affected (0.14 sec)</span><br></pre></td></tr></table></figure>

<p>查看表结构</p>
<ul>
<li>DESC 表名;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; DESC t_stu;</span><br><span class="line">+--------+--------------+------+-----+---------+-------+</span><br><span class="line">| Field  | Type         | Null | Key | Default | Extra |</span><br><span class="line">+--------+--------------+------+-----+---------+-------+</span><br><span class="line">| sid    | int(11)      | YES  |     | NULL    |       |</span><br><span class="line">| sname  | varchar(100) | YES  |     | NULL    |       |</span><br><span class="line">| gender | char(1)      | YES  |     | NULL    |       |</span><br><span class="line">+--------+--------------+------+-----+---------+-------+</span><br><span class="line">3 rows in set (0.03 sec)</span><br></pre></td></tr></table></figure>

<p>插入记录</p>
<ul>
<li>INSERT INTO 表名 VALUES(列值…);</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; INSERT INTO t_stu VALUES(1,&#39;张三&#39;,&#39;男&#39;);</span><br><span class="line">Query OK, 1 row affected (0.06 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; INSERT INTO t_stu VALUES(2,&#39;李四&#39;,&#39;男&#39;);</span><br><span class="line">Query OK, 1 row affected (0.09 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; INSERT INTO t_stu VALUES(3,&#39;王五&#39;,&#39;男&#39;);</span><br><span class="line">Query OK, 1 row affected (0.06 sec)</span><br></pre></td></tr></table></figure>

<p>查看记录</p>
<ul>
<li>SELECT * FROM 表名;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM t_stu;</span><br><span class="line">+------+-------+--------+</span><br><span class="line">| sid  | sname | gender |</span><br><span class="line">+------+-------+--------+</span><br><span class="line">|    1 | 张三      | 男       |</span><br><span class="line">|    2 | 李四      | 男       |</span><br><span class="line">|    3 | 王五      | 男       |</span><br><span class="line">+------+-------+--------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>修改记录</p>
<ul>
<li>UPDATE 表名 SET 列名 = 值 WHERE 条件;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; UPDATE t_stu SET sname &#x3D; &#39;张三丰&#39; WHERE sid &#x3D; 1;</span><br><span class="line">Query OK, 1 row affected (0.08 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM t_stu;</span><br><span class="line">+------+--------+--------+</span><br><span class="line">| sid  | sname  | gender |</span><br><span class="line">+------+--------+--------+</span><br><span class="line">|    1 | 张三丰       | 男       |</span><br><span class="line">|    2 | 李四       | 男       |</span><br><span class="line">|    3 | 王五       | 男       |</span><br><span class="line">+------+--------+--------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>删除记录</p>
<ul>
<li>DELETE FROM 表名 WHERE 条件;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; DELETE FROM t_stu WHERE sid &#x3D; 1;</span><br><span class="line">Query OK, 1 row affected (0.08 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM t_stu;</span><br><span class="line">+------+-------+--------+</span><br><span class="line">| sid  | sname | gender |</span><br><span class="line">+------+-------+--------+</span><br><span class="line">|    2 | 李四      | 男       |</span><br><span class="line">|    3 | 王五      | 男       |</span><br><span class="line">+------+-------+--------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>



<h2 id="错误ERROR-：没有选择数据库就操作表格和数据"><a href="#错误ERROR-：没有选择数据库就操作表格和数据" class="headerlink" title="错误ERROR ：没有选择数据库就操作表格和数据"></a>错误ERROR ：没有选择数据库就操作表格和数据</h2><blockquote>
<p>ERROR 1046 (3D000): No database selected</p>
<p>解决方案一：就是使用“USE 数据库名;”语句，这样接下来的语句就默认针对这个数据库进行操作</p>
<p>解决方案二：就是所有的表对象前面都加上“数据库.”</p>
</blockquote>
<h2 id="命令行客户端的字符集问题"><a href="#命令行客户端的字符集问题" class="headerlink" title="命令行客户端的字符集问题"></a>命令行客户端的字符集问题</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; INSERT INTO t_stu VALUES(1,&#39;张三&#39;,&#39;男&#39;);</span><br><span class="line">ERROR 1366 (HY000): Incorrect string value: &#39;\xD5\xC5\xC8\xFD&#39; for column &#39;sname&#39; at row 1</span><br></pre></td></tr></table></figure>

<p>原因：服务器端认为你的客户端的字符集是utf-8，而实际上你的客户端的字符集是GBK</p>
<ul>
<li>SHOW VARIABLES LIKE ‘character_set_%’;    查看所有字符集</li>
</ul>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql8.png" alt="mysql"></p>
<ul>
<li>SET NAMES GBK;    设置当前连接的客户端字符集</li>
</ul>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql9.png" alt="mysql"></p>
<h2 id="查看字符集和校对规则"><a href="#查看字符集和校对规则" class="headerlink" title="查看字符集和校对规则"></a>查看字符集和校对规则</h2><p>关于SQL的关键字和函数名等不区分大小写，但是对于数据值是否区分大小写，和字符集与校对规则有关。</p>
<p>_ci（大小写不敏感），_cs（大小写敏感），_bin（二元，即比较是基于字符编码的值而与language无关）</p>
<h3 id="查看所有字符集和校对规则"><a href="#查看所有字符集和校对规则" class="headerlink" title="查看所有字符集和校对规则"></a>查看所有字符集和校对规则</h3><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql10.png" alt="mysql"></p>
<h3 id="查看GBK和UTF-8字符集的校对规则"><a href="#查看GBK和UTF-8字符集的校对规则" class="headerlink" title="查看GBK和UTF-8字符集的校对规则"></a>查看GBK和UTF-8字符集的校对规则</h3><ul>
<li>show collation like ‘gbk%’;</li>
</ul>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql11.png" alt="mysql"></p>
<ul>
<li>show collation like ‘utf8%’;</li>
</ul>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql12.png" alt="mysql"></p>
<p>utf8_unicode_ci和utf8_general_ci对中、英文来说没有实质的差别。<br>utf8_general_ci 校对速度快，但准确度稍差。<br>utf8_unicode_ci 准确度高，但校对速度稍慢。</p>
<p>如果你的应用有德语、法语或者俄语，请一定使用utf8_unicode_ci。一般用utf8_general_ci就够了。</p>
<h3 id="查看服务器的字符集和校对规则"><a href="#查看服务器的字符集和校对规则" class="headerlink" title="查看服务器的字符集和校对规则"></a>查看服务器的字符集和校对规则</h3><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql13.png" alt="mysql"></p>
<h3 id="查看和修改某个数据库的字符集和校对规则"><a href="#查看和修改某个数据库的字符集和校对规则" class="headerlink" title="查看和修改某个数据库的字符集和校对规则"></a>查看和修改某个数据库的字符集和校对规则</h3><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql14.png" alt="mysql"></p>
<p>或</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql15.png" alt="mysql"></p>
<p>修改数据库的字符集和校对规则：</p>
<p>ALTER DATABASE 数据库名称 DEFAULT CHARACTER SET 字符集名称 【COLLATE 校对规则名称】;</p>
<p>例如：</p>
<p>ALTER DATABASE ceshi_db DEFAULT CHARACTER SET utf8 collate utf8_general_ci;</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql16.png" alt="mysql"></p>
<p>注意：修改了数据库的默认字符集和校对规则后，原来已经创建的表格的字符集和校对规则并不会改变，如果需要，那么需要单独修改。</p>
<h3 id="查看某个表格的字符集和校对规则"><a href="#查看某个表格的字符集和校对规则" class="headerlink" title="查看某个表格的字符集和校对规则"></a>查看某个表格的字符集和校对规则</h3><ul>
<li>show create table users;    查看字符集</li>
</ul>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql17.png" alt="mysql"></p>
<ul>
<li>show table status from bookstore like ‘%users%’ ;    查看校对规则</li>
</ul>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql18.png" alt="mysql"></p>
<p>修改某个表格的字符集和校对规则：</p>
<p>修改表的默认字符集：</p>
<p>ALTER TABLE 表名称 DEFAULT CHARACTER SET 字符集名称 【COLLATE 校对规则名称】;</p>
<p>把表默认的字符集和所有字符列（CHAR,VARCHAR,TEXT）改为新的字符集：</p>
<p>ALTER TABLE 表名称 CONVERT TO CHARACTER SET 字符集名称 【COLLATE 校对规则名称】;</p>
<p>例如：ALTER TABLE ceshi_table DEFAULT CHARACTER SET gbk collate gbk_chinese_ci;</p>
<h1 id="MySQL的数据类型"><a href="#MySQL的数据类型" class="headerlink" title="MySQL的数据类型"></a>MySQL的数据类型</h1><p>常用的数据类型有：</p>
<ul>
<li>整型（xxxint）</li>
<li>位类型(bit)</li>
<li>浮点型（float和double、real）</li>
<li>定点数（decimal,numeric）</li>
<li>日期时间类型（date,time,datetime,year）</li>
<li>字符串（char,varchar,xxxtext）</li>
<li>二进制数据（xxxBlob、xxbinary）</li>
<li>枚举（enum）</li>
<li>集合（set）</li>
</ul>
<h2 id="整数（xxxint）"><a href="#整数（xxxint）" class="headerlink" title="整数（xxxint）"></a>整数（xxxint）</h2><table>
<thead>
<tr>
<th>整数类型</th>
<th>字节</th>
<th>最小值（有符号/无符号）</th>
<th>最大值（有符号/无符号）</th>
</tr>
</thead>
<tbody><tr>
<td>TINYINT</td>
<td>1</td>
<td>-128/0</td>
<td>127/255</td>
</tr>
<tr>
<td>SMALLINT</td>
<td>2</td>
<td>-32768/0</td>
<td>32767/65535</td>
</tr>
<tr>
<td>MEDIUMINT</td>
<td>3</td>
<td>-8388608/0</td>
<td>8388607/1677215</td>
</tr>
<tr>
<td>INT、INTEGER</td>
<td>4</td>
<td>-2147483648/0</td>
<td>2147483647/4294967295</td>
</tr>
<tr>
<td>BIGINT</td>
<td>8</td>
<td>-9223372036854775808/0</td>
<td>9223372036854775807/18446744073709551615</td>
</tr>
</tbody></table>
<p>整数列的可选属性有三个：</p>
<ul>
<li>M: 宽度(在0填充的时候才有意义，否则不需要指定)</li>
<li>unsigned: 无符号类型(非负)</li>
<li>zerofill: 0填充,(如果某列是zerofill，那么默认就是无符号)，如果指定了zerofill只是表示不够M位时，用0在左边填充，如果超过M位，只要不超过数据存储范围即可</li>
</ul>
<p>原来，在 int(M) 中，M 的值跟 int(M) 所占多少存储空间并无任何关系。 int(3)、int(4)、int(8) 在磁盘上都是占用 4 bytes 的存储空间。</p>
<h2 id="浮点型"><a href="#浮点型" class="headerlink" title="浮点型"></a>浮点型</h2><p>对于浮点列类型，在MySQL中单精度值使用4个字节，双精度值使用8个字节</p>
<ul>
<li>MySQL允许使用非标准语法（其他数据库未必支持，因此如果设计到数据迁移，则最好不要这么用）：FLOAT(M,D)或DOUBLE(M,D)。这里，(M,D)表示该值一共显示M位，其中D表示小数点后几位，M和D又称为精度和标度。例如，定义为FLOAT(5,2)的一个列可以显示为-999.99-999.99。M取值范围为0<del>255。D取值范围为0</del>30，同时必须&lt;=M。</li>
<li>如果存储时，整数部分超出了范围（如上面的例子中，添加数值为1000.01），MySql就会报错，不允许存这样的值。如果存储时，小数点部分若超出范围，就分以下情况：若四舍五入后，整数部分没有超出范围，则只警告，但能成功操作并四舍五入删除多余的小数位后保存，例如在FLOAT(5,2)列内插入999.009，近似结果是999.01。若四舍五入后，整数部分超出范围，则MySql报错，并拒绝处理。如999.995和-999.995都会报错。</li>
<li>说明：小数类型，也可以加unsigned，但是不会改变数据范围，例如：float(3,2) unsigned仍然只能表示0-9.99的范围。</li>
<li>float和double在不指定精度时，默认会按照实际的精度（由实际的硬件和操作系统决定）来显示</li>
<li>REAL就是DOUBLE ，如果SQL服务器模式包括REAL_AS_FLOAT选项，REAL是FLOAT的同义词而不是DOUBLE的同义词。</li>
</ul>
<p>注意：在编程中，如果用到浮点数，要特别注意误差问题，因为浮点数是不准确的，所以我们要避免使用“=”来判断两个数是否相等。如果希望保证值比较准确，推荐使用定点数数据类型。</p>
<h2 id="定点型"><a href="#定点型" class="headerlink" title="定点型"></a>定点型</h2><ul>
<li>DECIMAL在MySQL内部以字符串形式存放，比浮点数更精确。定点类型占M+2个字节</li>
<li>DECIMAL(M,D)与浮点型一样处理规则。M的取值范围为0<del>65，D的取值范围为0</del>30，而且必须&lt;=M，超出范围会报错。</li>
<li>DECIMAL如果指定精度时，默认的整数位是10，默认的小数位为0。</li>
<li>NUMERIC等价于DECIMAL。</li>
</ul>
<h2 id="日期时间类型"><a href="#日期时间类型" class="headerlink" title="日期时间类型"></a>日期时间类型</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql19.png" alt="mysql"></p>
<ul>
<li>对于year类型，可以输入4位数，例如2018，也可以输入两位数，例如18，如果输入的是两位，“00-68”表示2000-2069年，“70-99”表示1970-1999年。</li>
<li>‘YYYY-MM-DD HH:MM:SS’或’YY-MM-DD HH:MM:SS’，’YYYY-MM-DD’或’YY-MM-DD’格式的字符串。允许“不严格”语法：任何标点符都可以用做日期部分或时间部分之间的间割符。例如，’98-12-31 11:30:45’、’98.12.31 11+30+45’、’98/12/31 11<em>30</em>45’和‘98@12@31 11^30^45’是等价的。</li>
<li>‘YYYYMMDD’或’YYMMDD’格式的没有间割符的字符串，假定字符串对于日期类型是有意义的。例如，’19970523’和’970523’被解释为 ‘1997-05-23’，但’971332’是不合法的(它有一个没有意义的月和日部分)，将变为’0000-00-00’。</li>
<li>对于包括日期部分间割符的字符串值，如果日和月的值小于10，不需要指定两位数。’1979-6-9’与’1979-06-09’是相同的。同样，对于包括时间部分间割符的字符串值，如果时、分和秒的值小于10，不需要指定两位数。’1979-10-30 1:2:3’与’1979-10-30 01:02:03’相同。</li>
<li>数字值应为6、8、12或者14位长。如果一个数值是8或14位长，则假定为YYYYMMDD或YYYYMMDDHHMMSS格式，前4位数表示年。如果数字 是6或12位长，则假定为YYMMDD或YYMMDDHHMMSS格式，前2位数表示年。其它数字被解释为仿佛用零填充到了最近的长度。</li>
<li>一般存注册时间、商品发布时间等，不建议使用datetime存储，而是使用时间戳，因为datetime虽然直观，但不便于计算。而且timestamp还有一个重要特点，就是和时区有关。还有如果插入NULL，会自动设置为当前系统时间。</li>
</ul>
<h2 id="字符串型"><a href="#字符串型" class="headerlink" title="字符串型"></a>字符串型</h2><table>
<thead>
<tr>
<th>类型</th>
<th>说明</th>
<th>典型声明方式</th>
<th>范围</th>
</tr>
</thead>
<tbody><tr>
<td>char</td>
<td>定长字符串</td>
<td>gender Char(1)</td>
<td>Char(M) 0&lt;=M&lt;=255</td>
</tr>
<tr>
<td>Varchar</td>
<td>变长字符串</td>
<td>email varchar(20)</td>
<td>Varchar(M) 0&lt;=M&lt;=65535 (约2W-6W个字符受字符集影响)</td>
</tr>
<tr>
<td>text</td>
<td>文本串</td>
<td>content text</td>
<td>约2W-6W个字符(受字符集影响)</td>
</tr>
</tbody></table>
<h3 id="char-varchar-text区别"><a href="#char-varchar-text区别" class="headerlink" title="char,varchar,text区别"></a>char,varchar,text区别</h3><p>char是一种固定长度的类型，varchar则是一种可变长度的类型，它们的区别是：</p>
<ul>
<li>char如果不指定(M)则表示长度默认是1个字符。varchar必须指定(M)。</li>
<li>char(M)类型的数据列里，每个值都占用M个<strong>字符</strong>，如果某个长度小于M，MySQL就会在它的右边用空格字符补足（在检索操作中那些填补出来的空格字符将被去掉；如果存入时右边本身就带空格，检索时也会被去掉）；在varchar(M)类型的数据列里，每个值只占用刚好够用的字符再加上一个到两个用来记录其长度的字节（即总长度为L字符+1/2字字节）。</li>
<li>由于某种原因char 固定长度，所以在处理速度上要比varchar快速很多，但相对费存储空间，所以对存储不大，但在速度上有要求的可以使用char类型，反之可以用varchar类型来实例。</li>
<li>text文本类型，可以存比较大的文本段，搜索速度稍慢，因此如果不是特别大的内容，建议使用char，varchar来代替。还有text类型不用加默认值，加了也没用。而且text和blob类型的数据删除后容易导致“空洞”，使得文件碎片比较多，所以频繁使用的表不建议包含text类型字段，建议单独分出去，单独用一个表。</li>
</ul>
<h3 id="哪些情况使用char或varchar更好"><a href="#哪些情况使用char或varchar更好" class="headerlink" title="哪些情况使用char或varchar更好"></a>哪些情况使用char或varchar更好</h3><ul>
<li>一，存储很短的信息，比如门牌号码101，201……这样很短的信息应该用char，因为varchar还要占个byte用于存储信息长度，本来打算节约存储的现在得不偿失。</li>
<li>二，固定长度的。比如使用uuid作为主键，那用char应该更合适。因为他固定长度，varchar动态根据长度的特性就消失了，而且还要占个长度信息。</li>
<li>三，十分频繁改变的column。因为varchar每次存储都要有额外的计算，得到长度等工作，如果一个非常频繁改变的，那就要有很多的精力用于计算，而这些对于char来说是不需要的。</li>
<li>MyISAM和MEMORY存储引擎中无论使用char还是varchar其实都是作为char类型处理的。</li>
<li>其他像InnoDB存储引擎，建议使用varchar类型，因为对于InnoDB数据表，内部的行存储格式并没有区分固定长度和可变长度列（所有数据行都使用指向数据列值的头指针），而且主要影响性能的因素是数据行使用的存储总量，由于char平均占用的空间多于varchar，所以除了简短并且固定长度的，其他考虑varchar。</li>
</ul>
<h2 id="位类型"><a href="#位类型" class="headerlink" title="位类型"></a>位类型</h2><p>BIT数据类型可用来保存位字段值。BIT(M)类型允许存储M位值。M范围为1~64，默认为1。</p>
<p>BIT其实就是存入二进制的值，类似010110。如果存入一个BIT类型的值，位数少于M值，则左补0。如果存入一个BIT类型的值，位数多于M值，MySQL的操作取决于此时有效的SQL模式：如果模式未设置，MySQL将值裁剪到范围的相应端点，并保存裁减好的值。如果模式设置为traditional(“严格模式”)，超出范围的值将被拒绝并提示错误，并且根据SQL标准插入会失败。</p>
<p>对于位字段，直接使用SELECT命令将不会看到结果，可以用bin()或hex()函数进行读取。</p>
<h2 id="二进制值类型"><a href="#二进制值类型" class="headerlink" title="二进制值类型"></a>二进制值类型</h2><p>包括：xxxBLOB和xxxBINARY</p>
<p>BINARY和VARBINARY类型类似于CHAR和VARCHAR类型，但是不同的是，它们存储的不是字符字符串，而是二进制串。所以它们没有字符集，并且排序和比较基于列值字节的数值值。当保存BINARY(M)值时，在它们右边填充0x00(零字节)值以达到指定长度。取值时不删除尾部的字节。比较时所有字节很重要（因为空格和0x00是不同的，0x00&lt;空格），包括ORDER BY和DISTINCT操作。比如插入’a ‘会变成’a \0’。</p>
<p>BLOB是一个二进制大对象，可以容纳可变数量的数据。有4种BLOB类型：TINYBLOB、BLOB、MEDIUMBLOB和LONGBLOB。它们只是可容纳值的最大长度不同。分别与四种TEXT类型：TINYTEXT、TEXT、MEDIUMTEXT和LONGTEXT对应有相同的最大长度和存储需求。在TEXT或BLOB列的存储或检索过程中，不存在大小写转换。BLOB和TEXT列不能有默认值。BLOB或TEXT对象的最大大小由其类型确定，但在客户端和服务器之间实际可以传递的最大值由可用内存数量和通信缓存区大小确定。你可以通过更改max_allowed_packet变量的值更改消息缓存区的大小，但必须同时修改服务器和客户端程序。</p>
<h2 id="枚举（ENUM）"><a href="#枚举（ENUM）" class="headerlink" title="枚举（ENUM）"></a>枚举（ENUM）</h2><p>MySql中的ENUM是一个字符串对象，其值来自表创建时在列规定中显式枚举的一列值：</p>
<ul>
<li><p>可以插入空字符串””和NULL（如果运行NULL的话）。</p>
</li>
<li><p>如果你将一个非法值插入ENUM(也就是说，允许的值列之外的字符串)，如果是严格模式，将不能插入，如果是非严格模式，将选用第一个元素代替，并警告。</p>
</li>
<li><p>ENUM最多可以有65,535个成员，需要2个字节存储。</p>
</li>
<li><p>当创建表时，ENUM成员值的尾部空格将自动被删除。</p>
<p>例如：enum(‘M’,’F’)</p>
</li>
</ul>
<p>值的索引规则如下：</p>
<ul>
<li>来自列规定的允许的值列中的值从1开始编号。</li>
<li>空字符串错误值的索引值是0。</li>
<li>NULL值的索引是NULL。</li>
</ul>
<h2 id="集合（SET）"><a href="#集合（SET）" class="headerlink" title="集合（SET）"></a>集合（SET）</h2><p>SET和ENUM类型非常类似，也是一个字符串对象，里面包含0~64个成员。</p>
<p>SET和ENUM存储上有所不同，SET是根据成员的个数决定存储的字节数。</p>
<p>SET和ENUM最主要的区别在于SET类型一次可以选择多个成员，而ENUM则只能选择一个。</p>
<p>例如：set(‘a’,’b’,’c’,’d’)</p>
<h2 id="特殊的NULL值"><a href="#特殊的NULL值" class="headerlink" title="特殊的NULL值"></a>特殊的NULL值</h2><p><strong>Null特征：</strong></p>
<ol>
<li><p>所有的类型的值都可以是null，包括int、float等数据类型</p>
</li>
<li><p>空字符串””，不等于null，0也不等于null，false也不等于null</p>
</li>
<li><p>任何运算符,判断符碰到NULL,都得NULL</p>
</li>
<li><p>NULL的判断只能用is null,is not null</p>
</li>
<li><p>NULL 影响查询速度,一般避免使值为NULL</p>
</li>
</ol>
<p><strong>面试：</strong></p>
<p>为什么建表时,加not null default ‘’ 或 default 0</p>
<p>答:不想让表中出现null值.</p>
<p>为什么不想要的null的值</p>
<p>答:</p>
<ol>
<li><p>不好比较,null是一种特殊值,比较时,只能用专门的is null 和 is not null来比较.</p>
<p>碰到运算符,一律返回null</p>
</li>
<li><p>效率不高,影响提高索引效果.</p>
<p>因此,我们往往,在建表时 not null default ‘’ 或 default 0</p>
</li>
</ol>
<h1 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h1><p>SQL：Structure Query Language结构化查询语言，它是使用关系模型的数据库应用语言，由IBM上世纪70年代开发出来。后由美国国家标准局（ANSI）开始着手制定SQL标准，先后有SQL-86，SQL-89，SQL-92，SQL-99等标准。</p>
<h2 id="SQL的语言规范"><a href="#SQL的语言规范" class="headerlink" title="SQL的语言规范"></a>SQL的语言规范</h2><ul>
<li>mysql对于SQL语句不区分大小写，SQL语句关键字尽量大写</li>
<li>值，除了数值型，字符串型和日期时间类型使用单引号（’’）</li>
<li>别名，尽量使用双引号（””），而且不建议省略as</li>
<li>所有标点符号使用英文状态下的半角输入方式</li>
<li>必须保证所有(),单引号，双引号是成对结束的</li>
<li>可以使用（1）#单行注释 （2）–空格单行注释 （3）/*  多行注释  */</li>
</ul>
<p><strong>命名规则：</strong></p>
<ul>
<li>数据库、表名不得超过30个字符，变量名限制为29个</li>
<li>必须只能包含 A–Z, a–z, 0–9, _共63个字符</li>
<li>不能在对象名的字符间留空格</li>
<li>必须不能和用户定义的其他对象重名</li>
<li>必须保证你的字段没有和保留字、数据库系统或常用方法冲突</li>
<li>保持字段名和类型的一致性,在命名字段并为其指定数据类型的时候一定要保证一致性。假如数据类型在一个表里是整数,那在另一个表里可就别变成字符型了</li>
</ul>
<p>在命令行中的要求：</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql20.png" alt="mysql"></p>
<p>说明：一个语句可以分开多行编写，以;或\g结束</p>
<h2 id="SQL分类"><a href="#SQL分类" class="headerlink" title="SQL分类"></a>SQL分类</h2><p>SQL的分类：</p>
<ul>
<li><p>DDL（Data Definition Languages)：数据定义语言，这些语句定义了不同的数据段、数据库、表、列、索引等数据库对象。</p>
<p>主要的语句关键字包括create、drop、alter等。</p>
</li>
<li><p>DML（Data Manipulation Language）：数据操作语句，用于添加、删除、更新和查询数据库记录，并检查数据完整性。</p>
<p>主要的语句关键字包括insert、delete、update、select等。</p>
</li>
<li><p>DCL（Data Control Language）：数据控制语句，用于控制不同数据段直接的许可和访问级别的语句。这些语句定义了数据库、表、字段、用户的访问权限和安全级别。主要的语句关键字包括grant、revoke等。</p>
</li>
</ul>
<h1 id="DDL"><a href="#DDL" class="headerlink" title="DDL"></a>DDL</h1><h2 id="操作Database"><a href="#操作Database" class="headerlink" title="操作Database"></a>操作Database</h2><p>注意：database不能改名。一些可视化工具可以改名，它是建新库,把所有表复制到新库,再删旧库完成的。</p>
<h3 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h3><ul>
<li><p>create database 数据库名 [charset 字符集];  (关键字大写效果：CREATE DATABASE 数据库名;)</p>
<p>如果不指定字符集，则按照安装mysql服务时选择的默认字符集。</p>
</li>
</ul>
<h3 id="查看有哪些数据库"><a href="#查看有哪些数据库" class="headerlink" title="查看有哪些数据库"></a>查看有哪些数据库</h3><ul>
<li><p>show databases;</p>
<p>提示：当前用户有权限查看的</p>
</li>
</ul>
<h3 id="删除数据库"><a href="#删除数据库" class="headerlink" title="删除数据库"></a>删除数据库</h3><ul>
<li>drop database 数据库名;</li>
</ul>
<h3 id="选择数据库"><a href="#选择数据库" class="headerlink" title="选择数据库"></a>选择数据库</h3><ul>
<li>use 数据库名;</li>
</ul>
<h3 id="查看当前正在使用哪个数据库"><a href="#查看当前正在使用哪个数据库" class="headerlink" title="查看当前正在使用哪个数据库"></a>查看当前正在使用哪个数据库</h3><ul>
<li>select database();</li>
</ul>
<p>注意：要操作表格和数据之前必须先说明是对哪个数据库进行操作，否则就要对所有对象加上“数据库名.”</p>
<h2 id="表结构的操作TABLE"><a href="#表结构的操作TABLE" class="headerlink" title="表结构的操作TABLE"></a>表结构的操作TABLE</h2><h3 id="查看当前数据库的所有表格"><a href="#查看当前数据库的所有表格" class="headerlink" title="查看当前数据库的所有表格"></a>查看当前数据库的所有表格</h3><ul>
<li><p>show tables;  </p>
<p>前面必须有use 数据库名语句，否则报错ERROR 1046 (3D000): No database selected</p>
</li>
<li><p>show tables from 数据库名;</p>
</li>
</ul>
<h3 id="创建表结构"><a href="#创建表结构" class="headerlink" title="创建表结构"></a>创建表结构</h3><h4 id="基础版"><a href="#基础版" class="headerlink" title="基础版"></a>基础版</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CREATE TABLE 表名称(</span><br><span class="line">	字段名1 数据类型1,</span><br><span class="line">	字段名2 数据类型2,</span><br><span class="line">	字段名3 数据类型3</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">CREATE TABLE t_stu(</span><br><span class="line">	sid INT,</span><br><span class="line">	sname VARCHAR(100),</span><br><span class="line">	gender CHAR</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 如果没有使用ust 数据库名的情况</span><br><span class="line">CREATE TABLE 数据库名.t_stu(</span><br><span class="line">	sid INT,</span><br><span class="line">	sname VARCHAR(100),</span><br><span class="line">	gender CHAR</span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<h4 id="详细版"><a href="#详细版" class="headerlink" title="详细版"></a>详细版</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CREATE TABLE 表名称(</span><br><span class="line">	字段名1 数据类型1 主键 自增长,</span><br><span class="line">	字段名2 数据类型2 非空 默认值,</span><br><span class="line">	字段名3 数据类型3</span><br><span class="line">)ENGINE&#x3D;当前表格的引擎 AUTO_INCREMENT&#x3D;自增长的起始值 DEFAULT CHARSET&#x3D;表数据的默认字符集;</span><br><span class="line"></span><br><span class="line">CREATE TABLE t_stu(</span><br><span class="line">	sid INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">	sname VARCHAR(100) NOT NULL,</span><br><span class="line">	gender CHAR NOT NULL DEFAULT &#39;男&#39;</span><br><span class="line">)ENGINE&#x3D;INNODB AUTO_INCREMENT&#x3D;1 DEFAULT CHARSET&#x3D;utf8;</span><br></pre></td></tr></table></figure>



<h3 id="查看表结构"><a href="#查看表结构" class="headerlink" title="查看表结构"></a>查看表结构</h3><ul>
<li>desc 表名称;</li>
<li>SHOW CREATE TABLE 表名;    查看表的定义</li>
</ul>
<h3 id="删除表结构"><a href="#删除表结构" class="headerlink" title="删除表结构"></a>删除表结构</h3><ul>
<li>drop table 表名称;</li>
</ul>
<p>注意：</p>
<p>数据和结构都被删除</p>
<p>所有正在运行的相关事务被提交</p>
<p>所有相关索引被删除</p>
<p>DROP TABLE 语句不能回滚</p>
<h3 id="修改表结构"><a href="#修改表结构" class="headerlink" title="修改表结构"></a>修改表结构</h3><h4 id="重命名表"><a href="#重命名表" class="headerlink" title="重命名表"></a>重命名表</h4><ul>
<li><p>alter table 表名 rename 新表名;</p>
</li>
<li><p>rename table 表名 to 新表名; </p>
</li>
</ul>
<h4 id="增加一列"><a href="#增加一列" class="headerlink" title="增加一列"></a>增加一列</h4><ul>
<li><p>alter table 表名 add 【column】 列名 数据类型 【default 默认值】【not null】;  #默认在最后</p>
</li>
<li><p>alter table 表名 add 【column】 列名 数据类型 【default 默认值】【not null】 after 某一列;</p>
</li>
<li><p>alter table 表名 add 【column】 列名 数据类型 【default 默认值】【not null】 first;</p>
</li>
</ul>
<h4 id="删除列"><a href="#删除列" class="headerlink" title="删除列"></a>删除列</h4><ul>
<li>alter table 表名 drop 【column】 列名;</li>
</ul>
<h4 id="修改列类型"><a href="#修改列类型" class="headerlink" title="修改列类型"></a>修改列类型</h4><ul>
<li><p>alter table 表名 modify 【column】 列名 数据类型【default 默认值】【not null】;</p>
</li>
<li><p>alter table 表名 modify 【column】 列名 数据类型【default 默认值】【not null】 after 某一列;</p>
</li>
<li><p>alter table 表名 modify 【column】 列名 数据类型【default 默认值】【not null】 first;</p>
</li>
</ul>
<h4 id="修改列名等"><a href="#修改列名等" class="headerlink" title="修改列名等"></a>修改列名等</h4><ul>
<li>alter table 表名 change 【column】 列名 新列名 数据类型【default 默认值】【not null】;</li>
</ul>
<h3 id="约束：CONSTRAINTS"><a href="#约束：CONSTRAINTS" class="headerlink" title="约束：CONSTRAINTS"></a>约束：CONSTRAINTS</h3><p>数据完整性（Data Integrity）是指数据的精确性（Accuracy）和可靠性（Reliability）。它是应防止数据库中存在不符合语义规定的数据和防止因错误信息的输入输出造成无效操作或错误信息而提出的。数据的完整性要从以下四个方面考虑：</p>
<ul>
<li>实体完整性（Entity Integrity）：例如，同一个表中，不能存在两条完全相同无法区分的记录</li>
<li>域完整性（Domain Integrity）：例如：年龄范围0-120，性别范围“男/女”</li>
<li>引用完整性（Referential Integrity）：例如：员工所在部门，在部门表中要能找到这个部门</li>
<li>用户自定义完整性（User-defined Integrity）：例如：用户名唯一、密码不能为空等，本部门经理的工资不得高于本部门职工的平均工资的5倍。</li>
</ul>
<p><strong>根据约束的特点，分为几种：</strong></p>
<ul>
<li>键约束：主键约束、外键约束、唯一键约束</li>
<li>Not NULL约束：非空约束</li>
<li>Check约束：检查约束</li>
<li>Default约束：缺省约束</li>
</ul>
<h4 id="查看某个表的约束和索引"><a href="#查看某个表的约束和索引" class="headerlink" title="查看某个表的约束和索引"></a>查看某个表的约束和索引</h4><ul>
<li>SELECT * FROM information_schema.table_constraints WHERE table_name = ‘表名称’;</li>
<li>SHOW INDEX FROM 表名称;</li>
<li>SHOW CREATE TABLE 表名;</li>
</ul>
<h4 id="主键约束PRIMARY-KEY"><a href="#主键约束PRIMARY-KEY" class="headerlink" title="主键约束PRIMARY KEY"></a>主键约束PRIMARY KEY</h4><p>主键：Primary key，简称PK，数据库主键作用保证实体的完整性，可以是一个列或多列的组合。</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql21.png" alt="mysql"></p>
<ul>
<li><p>主键约束相当于<strong>唯一约束+非空约束</strong>的组合，主键约束列不允许重复，也不允许出现空值，如果是多列组合的主键约束，那么这些列都不允许为空值，并且组合的值不允许重复。</p>
</li>
<li><p><strong>每个表有且最多只允许一个主键约束</strong>。</p>
</li>
<li><p>MySQL的主键名总是PRIMARY，就算自己命名了主键约束名也没用。</p>
</li>
<li><p>当创建主键约束时，MySQL默认在对应的列上建立<strong>主键键索</strong>。删除主键时，也会直接删除主键索引。</p>
</li>
</ul>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql22.png" alt="mysql"></p>
<h4 id="唯一键Unique-key，简称UK"><a href="#唯一键Unique-key，简称UK" class="headerlink" title="唯一键Unique key，简称UK"></a>唯一键Unique key，简称UK</h4><ul>
<li>同一个表可以有多个唯一约束。</li>
<li>唯一约束可以是某一个列的值唯一，也可以多个列组合值的唯一。</li>
<li>MySQL会给唯一约束的列上默认创建一个<strong>唯一索引</strong>。</li>
<li>删除唯一键只能通过删除唯一索引的方式删除，删除时需要指定唯一索引名，唯一索引名就是唯一约束名一样。如果创建唯一约束时未指定名称，如果是单列，就默认和列名相同，如果是组合列，那么默认和()中排在第一个的列名相同。也可以自定义唯一性约束名。</li>
</ul>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql23.png" alt="mysql"></p>
<h4 id="外键：Foreign-key，简称FK"><a href="#外键：Foreign-key，简称FK" class="headerlink" title="外键：Foreign key，简称FK"></a>外键：Foreign key，简称FK</h4><ul>
<li>外键约束是保证一个或两个表之间的参照完整性,外键是构建于一个表的两个字段或是两个表的两个字段之间的参照关系。</li>
<li>在创建外键约束时，如果不给外键约束名称，默认名不是列名，而是自动产生一个外键名（例如 student_ibfk_1;），也可以指定外键约束名。</li>
<li>当创建外键约束时，系统默认会在所在的列上建立对应的<strong>普通索引</strong>。但是索引名是列名，不是外键的约束名。</li>
<li>删除外键时，关于外键列上的普通<strong>索引需要单独删除</strong>。</li>
</ul>
<p><strong>约束关系：</strong></p>
<p>约束是针对双方的</p>
<ul>
<li>添加了外键约束后，主表的修改和删除受约束</li>
<li>添加了外键约束后，从表的添加和修改受约束</li>
</ul>
<p><strong>5个约束等级</strong></p>
<ul>
<li>Cascade方式：在父表上update/delete记录时，同步update/delete掉子表的匹配记录</li>
<li>Set null方式：在父表上update/delete记录时，将子表上匹配记录的列设为null，但是要注意子表的外键列不能为not null</li>
<li>No action方式：如果子表中有匹配的记录,则不允许对父表对应候选键进行update/delete操作</li>
<li>Restrict方式：同no action, 都是立即检查外键约束</li>
<li>Set default方式（在可视化工具SQLyog中可能显示空白）：父表有变更时,子表将外键列设置成一个默认的值，但Innodb不能识别如果没有指定等级，就相当于Restrict方式</li>
</ul>
<p><strong>注意：</strong></p>
<ul>
<li>在从表上建立外键，而且主表要先存在。</li>
<li>从表的外键列，在主表中引用的只能是键列（主键，唯一键，外键）。</li>
<li>从表的外键列与主表被参照的列名字可以不相同，但是数据类型必须一样。</li>
<li>一个表可以建立多个外键约束</li>
<li>从表的外键值必须”在主表中能找到”或者为空，从而约束了从表的外键列的值的添加和修改。</li>
<li>当主表的记录被从表参照时，主表中被参考记录的删除和更新也会受到限制。<ul>
<li><ol>
<li>默认情况下，主表和从表是严格依赖关系RESTRICT。当主表的记录被从表参照时，主表的记录将不允许删除，如果要删除数据，需要先删除从表中依赖该记录的数据，然后才可以删除主表的数据。</li>
</ol>
</li>
<li><ol start="2">
<li>但是有一种是级联“修改、删除”：</li>
</ol>
</li>
<li>ON DELETE SET NULL(级联置空)：当外键设置了SET NULL,当主表的相关记录删除时，从表对应的字段改为NULL。注意从表外键字段得允许为空才行</li>
<li>ON DELETE CASCADE(级联删除)：当外键设置了CASCADE（级联），当主表的相关记录删除时，从表对应的行都删除了。</li>
<li>对于外键约束,最好是采用: ON UPDATE CASCADE ON DELETE RESTRICT 的方式</li>
</ul>
</li>
<li>如果要删除表，需要先删除从表，才能删除主表</li>
</ul>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql24.png" alt="mysql"></p>
<p>如何建立外键约束？</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 创建外键</span><br><span class="line"></span><br><span class="line">CREATE TABLE t_department(</span><br><span class="line">	did INT PRIMARY KEY,</span><br><span class="line">	dname VARCHAR(100) NOT NULL UNIQUE,</span><br><span class="line">	description VARCHAR(200) NOT NULL</span><br><span class="line">);</span><br><span class="line">CREATE TABLE t_employee(</span><br><span class="line">	eid INT PRIMARY KEY,</span><br><span class="line">	ename VARCHAR(100) NOT NULL,</span><br><span class="line">	dept_id INT,</span><br><span class="line">	CONSTRAINT fk_emp_dept_did FOREIGN KEY(dept_id) REFERENCES t_department(did) ON UPDATE CASCADE ON DELETE RESTRICT</span><br><span class="line">);</span><br><span class="line">#其中CONSTRAINT fk_emp_dept_did可以省略</span><br><span class="line">#ON UPDATE CASCADE ON DELETE RESTRICT如果省略表示都是RESTRICT</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 一个表可以有多个外键，而且主表和从表可以是一张表</span><br><span class="line"></span><br><span class="line">CREATE TABLE t_emp(</span><br><span class="line">	eid INT PRIMARY KEY,</span><br><span class="line">	ename VARCHAR(100) NOT NULL,</span><br><span class="line">	manager_id INT,</span><br><span class="line">	dept_id INT,</span><br><span class="line">	CONSTRAINT fk_emp_dept_did FOREIGN KEY(dept_id) REFERENCES t_department(did)  ON UPDATE CASCADE ON DELETE RESTRICT,</span><br><span class="line">	CONSTRAINT fk_emp_mid_eid FOREIGN KEY(manager_id) REFERENCES t_emp(eid)  ON UPDATE CASCADE ON DELETE RESTRICT</span><br><span class="line">);</span><br><span class="line">#其中CONSTRAINT fk_emp_dept_did可以省略</span><br><span class="line">#ON UPDATE CASCADE ON DELETE RESTRICT如果省略表示都是RESTRICT</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 建表后创建外键</span><br><span class="line"></span><br><span class="line">alter table表名称 add 【constraint 约束名】 foreign key (从表字段名) references 主表名(主表被参照字段名);</span><br><span class="line">ALTER TABLE t_emp ADD CONSTRAINT fk_emp_dept_did FOREIGN KEY(dept_id) REFERENCES t_department(did)  ON UPDATE CASCADE ON DELETE RESTRICT;</span><br><span class="line">#其中CONSTRAINT fk_emp_dept_did可以省略</span><br><span class="line">#ON UPDATE CASCADE ON DELETE RESTRICT如果省略表示都是RESTRICT</span><br></pre></td></tr></table></figure>

<p>如何删除外键约束？</p>
<ul>
<li><p>ALTER TABLE 表名称 DROP FOREIGN KEY 外键约束名;</p>
<p>ALTER TABLE t_emp DROP FOREIGN KEY fk_emp_dept_did;</p>
</li>
</ul>
<p>查看约束名</p>
<ul>
<li>SELECT * FROM information_schema.table_constraints WHERE table_name = ‘表名称’;</li>
</ul>
<p>如何删除外键列上的索引？需要单独删除</p>
<ul>
<li><p>ALTER TABLE 表名称 DROP INDEX 外键列索引名; </p>
<p>ALTER TABLE t_emp DROP INDEX dept_id;</p>
</li>
</ul>
<p>查看索引名</p>
<ul>
<li>show index from 表名称;</li>
</ul>
<h4 id="非空约束"><a href="#非空约束" class="headerlink" title="非空约束"></a>非空约束</h4><ul>
<li>NOT NULL 非空约束，规定某个字段不能为空</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CREATE TABLE t_stu(</span><br><span class="line">	sid INT PRIMARY KEY,</span><br><span class="line">	sname VARCHAR(100) NOT NULL</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>如果某列已经创建好，那么可以修改列语句修改：</p>
<p>例如：原来非空，修改为允许空</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ALTER TABLE ceshi_table MODIFY des VARCHAR(20);</span><br></pre></td></tr></table></figure>

<p>例如：原来允许空，修改为非空</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ALTER TABLE ceshi_table MODIFY des VARCHAR(20) NOT NULL;</span><br></pre></td></tr></table></figure>



<h4 id="检查约束"><a href="#检查约束" class="headerlink" title="检查约束"></a>检查约束</h4><p>注意： MySQL不支持check约束，但可以使用check约束，而没有任何效果；</p>
<p>例如：age tinyint check(age &gt;20)  或 sex char(2) check(sex in(‘男’,’女’))</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CREATE TABLE t_stu(</span><br><span class="line">	sid INT PRIMARY KEY,</span><br><span class="line">	sname VARCHAR(100) NOT NULL,</span><br><span class="line">	gender CHAR NOT NULL CHECK(gender IN(&#39;男&#39;,&#39;女&#39;))</span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<h4 id="Default缺省约束"><a href="#Default缺省约束" class="headerlink" title="Default缺省约束"></a>Default缺省约束</h4><p>default：默认值，在插入数据时某列如果没指定其他的值,那么会将默认值添加到新记录。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CREATE TABLE t_stu(</span><br><span class="line">	sid INT PRIMARY KEY,</span><br><span class="line">	sname VARCHAR(100) NOT NULL,</span><br><span class="line">	gender CHAR NOT NULL CHECK(gender IN(&#39;男&#39;,&#39;女&#39;))</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>如果某列已经创建好，那么可以修改列语句修改：</p>
<p>例如：原来有默认值，去除默认值</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ALTER TABLE ceshi_table MODIFY des VARCHAR(20);</span><br></pre></td></tr></table></figure>

<p>例如：原来没有默认值，增加默认值</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ALTER TABLE ceshi_table MODIFY des VARCHAR(20) DEFAULT &#39;略&#39;;</span><br></pre></td></tr></table></figure>



<h3 id="索引：INDEX"><a href="#索引：INDEX" class="headerlink" title="索引：INDEX"></a>索引：INDEX</h3><p><strong>索引</strong>：索引是对数据库表中一列或多列的值进行排序的一种结构。<strong>索引是一个单独的、物理的数据库结构</strong>，它是某个表中一列或若干列值的集合和相应的指向表中物理标识这些值的数据页的逻辑指针清单。由此可知，<strong>索引是要消耗数据库空间的</strong>。而<strong>约束是一种逻辑概念。</strong></p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql25.png" alt="mysql"></p>
<p>例如：一本字典，如何快速找到某个字，可以给字典加目录，对数据库来说,索引的作用即是给”数据”加目录。</p>
<p>设有N条随机记录,不用索引,平均查找N/2次,那么用了索引之后呢。如果是btree(二叉树)索引，如果是hash(哈希)索引，时间复杂度是1。</p>
<p><strong>索引好处</strong>：加快了查询速度(select )</p>
<p><strong>索引坏处</strong>：降低了增,删,改的速度(update/delete/insert)，增大了表的文件大小(索引文件甚至可能比数据文件还大)</p>
<p><strong>MySQL提供多种索引类型供选择：</strong></p>
<ul>
<li><p>普通索引：</p>
</li>
<li><p>唯一性索引：</p>
</li>
<li><p>主键索引：只有一个主键索引</p>
</li>
<li><p>全文索引：MySQL5.X版本只有MyISAM存储引擎支持FULLTEXT，并且只限于CHAR、VARCHAR和TEXT类型的列上创建。</p>
</li>
</ul>
<p><strong>MySQL的索引方法：</strong></p>
<ul>
<li><p>HASH</p>
</li>
<li><p>BTREE</p>
</li>
</ul>
<p>MySQL中多数索引都以BTREE的形式保存。</p>
<p><strong>索引的使用原则：</strong></p>
<ol>
<li><p>不过度索引</p>
</li>
<li><p>索引条件列(where后面最频繁的条件比较适宜索引)</p>
</li>
<li><p>索引散列值,过于集中的值不要索引，例如:给性别”男”,”女”加索引,意义不大</p>
</li>
</ol>
<ul>
<li><p>CREATE INDEX 索引名 ON 表名称 (column_name,[column_name…]);      最左边的列最关键</p>
</li>
<li><p>alter table 表名称 drop index 索引名;</p>
</li>
</ul>
<h3 id="自增列：AUTO-INCREMENT"><a href="#自增列：AUTO-INCREMENT" class="headerlink" title="自增列：AUTO_INCREMENT"></a>自增列：AUTO_INCREMENT</h3><p>例如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CREATE TABLE t_stu(</span><br><span class="line">	sid INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">	sname VARCHAR(100) NOT NULL,</span><br><span class="line">	gender CHAR NOT NULL DEFAULT &#39;男&#39;,</span><br><span class="line">	birthday DATE,</span><br><span class="line">	address VARCHAR(200)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li>auto_increment    自增长</li>
</ul>
<ol>
<li><p>整数类型的字段才可以设置自增长。</p>
</li>
<li><p>当需要产生唯一标识符或顺序值时，可设置自增长。</p>
</li>
<li><p>一个表最多只能有一个自增长列</p>
</li>
<li><p>自增长列必须非空</p>
</li>
<li><p>自增长列必须是主键列或唯一键列。</p>
</li>
<li><p>InnoDB表的自动增长列可以手动插入，但是插入的值如果是空或者0，则实际插入的将是自动增长后的值。</p>
</li>
</ol>
<h1 id="DML"><a href="#DML" class="headerlink" title="DML"></a>DML</h1><p>数据操作语言（DML）DML用于插入、修改、删除数据记录，包括如下SQL语句：</p>
<p>INSERT：添加数据到数据库中</p>
<p>UPDATE：修改数据库中的数据</p>
<p>DELETE：删除数据库中的数据</p>
<h2 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql26.png" alt="mysql"></p>
<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><ul>
<li>INSERT INTO 表名称  VALUES(值1，值2，……);</li>
<li>INSERT INTO 表名称  VALUES(值1，值2，……),(值1，值2，……),…;</li>
<li>INSERT INTO 表名称 (字段1，字段2，……) VALUES(值1，值2，……);</li>
<li>INSERT INTO 表名称 (字段1，字段2，……) VALUES(值1，值2，……),(值1，值2，……),…..;</li>
</ul>
<h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><ol>
<li>值列表(值1，值2，……)的顺序、个数与字段列表(字段1，字段2，……) 中字段的顺序、个数一致</li>
</ol>
<ul>
<li><p>如果个数少了就报Column count doesn’t match value count</p>
</li>
<li><p>如果VALUES前面的()中没有列出字段，那么默认就是为表中的所有字段赋值，那么个数与顺序与表结构中字段定义的一致</p>
</li>
</ul>
<ol start="2">
<li>关于自增长列、默认值列、允许为NULL列的赋值</li>
</ol>
<ul>
<li>如果字段列表列出了字段名，那么值列表中就要为其赋值，哪怕它是自增长列，有默认值列，可以为NULL值的列。<ul>
<li>InnoDB表的自动增长列可以手动插入合适的值，但是插入的值如果是NULL或者0，则实际插入的将是自动增长后的值；</li>
<li>如果列声明了“默认约束”那么对应的位置可以赋值具体的值，也可以使用“DEFAULT”，表示使用默认值；</li>
<li>如果列允许了NULL值，那么可以为对应的字段可以赋值为具体值也可以赋值为NULL</li>
</ul>
</li>
<li>对于没有列出的字段，像自增列就自动赋值，像默认值列就自动赋默认值，像允许NULL的列就自动赋NULL值，但是非空列又没有提供默认值会自动赋值为对应数据类型的默认值，例如字符串赋值为空字符串，int赋值为0；</li>
<li>VALUES也可以写成VALUE，但是VALUES是标准写法</li>
<li>可以同时插入多行</li>
<li>如果插入从表的数据，要注意查看主表参照字段的值是否存在</li>
<li>值的位置可以是常量值、表达式、函数</li>
</ul>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>练习（一）</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql27.png" alt="mysql"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CREATE TABLE t_stu(</span><br><span class="line">	sid INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">	sname VARCHAR(100) NOT NULL,</span><br><span class="line">	gender CHAR NOT NULL DEFAULT &#39;男&#39;,</span><br><span class="line">	card_id CHAR(18) NOT NULL UNIQUE,</span><br><span class="line">	birthday DATE,</span><br><span class="line">	address VARCHAR(200)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO t_stu VALUES(1,&#39;张三&#39;,DEFAULT,&#39;123456789012345678&#39;,&#39;1989-09-09&#39;,NULL);</span><br><span class="line">INSERT INTO t_stu VALUES(2,&#39;李四&#39;,&#39;女&#39;,&#39;123456789012345677&#39;,&#39;1988-09-09&#39;,&#39;北京&#39;);</span><br><span class="line">INSERT INTO t_stu VALUES(0,&#39;王五&#39;,&#39;男&#39;,&#39;123456789012345676&#39;,&#39;1987-09-09&#39;,&#39;北京&#39;);</span><br><span class="line">INSERT INTO t_stu VALUES(NULL,&#39;赵六&#39;,&#39;男&#39;,&#39;123456789012345675&#39;,&#39;1987-09-09&#39;,&#39;北京&#39;);</span><br><span class="line"></span><br><span class="line">INSERT INTO t_stu VALUES</span><br><span class="line">(NULL,&#39;冰冰&#39;,&#39;女&#39;,&#39;123456789012345674&#39;,&#39;1988-09-09&#39;,&#39;尚硅谷&#39;),</span><br><span class="line">(NULL,&#39;小丽&#39;,&#39;女&#39;,&#39;123456789012345673&#39;,&#39;1988-09-09&#39;,&#39;尚硅谷&#39;);</span><br><span class="line"></span><br><span class="line">INSERT INTO t_stu (sname,card_id,birthday)</span><br><span class="line">VALUES(&#39;小薇&#39;,&#39;123456199012045672&#39;,STR_TO_DATE(SUBSTRING(card_id,7,8),&#39;%Y%m%d&#39;));</span><br><span class="line"></span><br><span class="line">INSERT INTO t_stu (sname,card_id,birthday)VALUES</span><br><span class="line">(&#39;小红&#39;,&#39;123456789012345671&#39;,&#39;1990-09-09&#39;),</span><br><span class="line">(&#39;小紫&#39;,&#39;123456789012345670&#39;,&#39;1990-09-09&#39;);</span><br></pre></td></tr></table></figure>

<p>练习（二）</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql28.png" alt="mysql"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CREATE TABLE t_department(</span><br><span class="line">	did INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">	dname VARCHAR(100) NOT NULL,</span><br><span class="line">	description VARCHAR(200),</span><br><span class="line">	manager_id INT</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO t_department(dname,description) VALUES(&#39;教学部&#39;,&#39;技术培训&#39;),(&#39;咨询部&#39;,&#39;课程咨询服务&#39;);</span><br><span class="line"></span><br><span class="line">CREATE TABLE &#96;t_job&#96; (</span><br><span class="line">  &#96;job_id&#96; INT(11) PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">  &#96;job_name&#96; VARCHAR(100) DEFAULT NULL,</span><br><span class="line">  &#96;description&#96; VARCHAR(200) DEFAULT NULL</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">INSERT INTO t_job VALUES</span><br><span class="line">(NULL,&#39;JavaSE讲师&#39;,&#39;Java基础&#39;),</span><br><span class="line">(NULL,&#39;Web讲师&#39;,&#39;Web基础&#39;),</span><br><span class="line">(NULL,&#39;JavaEE框架&#39;,&#39;框架讲解&#39;),</span><br><span class="line">(NULL,&#39;课程顾问&#39;,&#39;课程咨询&#39;);</span><br><span class="line"></span><br><span class="line">CREATE TABLE t_employee(</span><br><span class="line">	eid INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">	ename VARCHAR(100) NOT NULL,</span><br><span class="line">	gender CHAR NOT NULL DEFAULT &#39;男&#39;,</span><br><span class="line">	card_id CHAR(18) UNIQUE,</span><br><span class="line">	tel CHAR(11),</span><br><span class="line">	job_id INT,</span><br><span class="line">	&#96;mid&#96; INT,</span><br><span class="line">	birthday DATE,</span><br><span class="line">	hiredate DATE,	</span><br><span class="line">	address VARCHAR(100),	</span><br><span class="line">	dept_id INT,</span><br><span class="line">	FOREIGN KEY (dept_id) REFERENCES t_department(did),</span><br><span class="line">	FOREIGN KEY (job_id) REFERENCES t_job(job_id)</span><br><span class="line">);</span><br><span class="line">INSERT  INTO &#96;t_employee&#96;(&#96;eid&#96;,&#96;ename&#96;,&#96;gender&#96;,&#96;card_id&#96;,&#96;tel&#96;,&#96;job_id&#96;,&#96;mid&#96;,&#96;birthday&#96;,&#96;hiredate&#96;,&#96;address&#96;,&#96;dept_id&#96;)</span><br><span class="line"> VALUES (1,&#39;孙红雷&#39;,&#39;男&#39;,&#39;123456789012345678&#39;,&#39;12345678901&#39;,1,NULL,&#39;1990-01-01&#39;,&#39;2015-01-01&#39;,&#39;白庙&#39;,1),</span><br><span class="line"> (2,&#39;张亮&#39;,&#39;男&#39;,&#39;123456789012345677&#39;,&#39;12345678902&#39;,2,NULL,&#39;1990-01-02&#39;,&#39;2015-01-02&#39;,&#39;天通苑北&#39;,1),</span><br><span class="line"> (3,&#39;鹿晗&#39;,&#39;男&#39;,&#39;123456789012345676&#39;,&#39;12345678903&#39;,3,NULL,&#39;1990-01-03&#39;,&#39;2015-01-03&#39;,&#39;北苑&#39;,1),</span><br><span class="line"> (4,&#39;邓超&#39;,&#39;男&#39;,&#39;123456789012345675&#39;,&#39;12345678904&#39;,2,NULL,&#39;1990-01-04&#39;,&#39;2015-01-04&#39;,&#39;和谐家园&#39;,1),</span><br><span class="line"> (5,&#39;孙俪&#39;,&#39;女&#39;,&#39;123456789012345674&#39;,&#39;12345678905&#39;,3,NULL,&#39;1990-01-05&#39;,&#39;2015-01-05&#39;,&#39;霍营&#39;,1),</span><br><span class="line"> (6,&#39;Angelababy&#39;,&#39;女&#39;,&#39;123456789012345673&#39;,&#39;12345678906&#39;,4,NULL,&#39;1990-01-06&#39;,&#39;2015-01-06&#39;,&#39;回龙观&#39;,2);</span><br><span class="line"> </span><br><span class="line"> CREATE TABLE t_salary(</span><br><span class="line">	eid INT PRIMARY KEY,</span><br><span class="line">	basic_salary DECIMAL(10,2),</span><br><span class="line">	performance_salary DECIMAL(10,2),</span><br><span class="line">	commission_pct DECIMAL(10,2),</span><br><span class="line">	deduct_wages DECIMAL(10,2),</span><br><span class="line">	FOREIGN KEY (eid) REFERENCES t_employee(eid)</span><br><span class="line">);</span><br><span class="line">INSERT  INTO &#96;t_salary&#96;(&#96;eid&#96;,&#96;basic_salary&#96;,&#96;performance_salary&#96;,&#96;commission_pct&#96;,&#96;deduct_wages&#96;) </span><br><span class="line">VALUES (1,&#39;12000.00&#39;,&#39;6000.00&#39;,&#39;0.40&#39;,&#39;0.00&#39;),</span><br><span class="line">(2,&#39;9000.00&#39;,&#39;5000.00&#39;,&#39;0.20&#39;,NULL),</span><br><span class="line">(3,&#39;11000.00&#39;,&#39;8000.00&#39;,NULL,NULL),</span><br><span class="line">(4,&#39;13000.00&#39;,&#39;5000.00&#39;,NULL,NULL),</span><br><span class="line">(5,&#39;8000.00&#39;,&#39;8000.00&#39;,&#39;0.30&#39;,NULL),</span><br><span class="line">(6,&#39;15000.00&#39;,&#39;6000.00&#39;,NULL,NULL);</span><br></pre></td></tr></table></figure>



<h2 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a><strong>修改数据</strong></h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql29.png" alt="mysql"></p>
<h3 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h3><ul>
<li>UPDATE 表名称 SET 字段名1 = 值1, 字段名2=值2,……  【WHERE  条件】; </li>
<li>UPDATE 表1，表2,……  SET  表1.字段名1 = 值1, 表1.字段名2=值2,表2.字段1 = 值1, 表2.字段2=值2……  【WHERE  条件】; </li>
</ul>
<h3 id="说明-1"><a href="#说明-1" class="headerlink" title="说明"></a>说明</h3><ol>
<li><p>如果不写where条件，会修改所有行</p>
</li>
<li><p>值可以是常量值、表达式、函数</p>
</li>
<li><p>可以同时更新多张表</p>
<p>如果两个表没有建立外键，但逻辑上有外键关系</p>
</li>
<li><p>如果修改从表外键字段的数据，要注意查看主表参照字段的值是否存在</p>
</li>
<li><p>如果修改主表的被参考的字段的值，要注意查看从表的外键是否有依赖该值，如果有</p>
<ul>
<li>如果外键是on update RESTRICT或on update NO ACTION，那么要先处理从表的数据，才能修改</li>
<li>如果外键是on update SET NULL 或 on update CASCADE，那么直接修改，从表的外键字段会自动处理</li>
</ul>
</li>
</ol>
<h3 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#修改所有人的基本工资，涨薪5%</span><br><span class="line">UPDATE t_salary </span><br><span class="line">SET basic_salary &#x3D; basic_salary * 1.05;</span><br><span class="line"></span><br><span class="line">#修改&quot;孙俪&quot;的手机号码为&quot;13709098765&quot;，生日为&quot;1982-09-26&quot;</span><br><span class="line">UPDATE t_employee SET tel &#x3D; &#39;13709098765&#39;,birthday &#x3D; &#39;1982-09-26&#39;</span><br><span class="line">WHERE ename &#x3D; &#39;孙俪&#39;;</span><br><span class="line"></span><br><span class="line">#修改&quot;邓超&quot;的入职日期为今天</span><br><span class="line">UPDATE t_employee SET hiredate &#x3D; CURDATE() WHERE ename &#x3D;&#39;邓超&#39;;</span><br><span class="line"></span><br><span class="line">#修改&quot;咨询部&quot;的主管id为6</span><br><span class="line">UPDATE t_department SET manager_id &#x3D;6 WHERE did &#x3D; 2;</span><br><span class="line"></span><br><span class="line">#修改&quot;教学部&quot;的主管id为1</span><br><span class="line">UPDATE t_department SET manager_id &#x3D;1 WHERE did &#x3D; 1;</span><br><span class="line"></span><br><span class="line">#修改&quot;教学部&quot;的主管id为&quot;孙红雷&quot;的编号</span><br><span class="line">UPDATE t_department,t_employee</span><br><span class="line">SET t_department.manager_id &#x3D;t_employee.eid</span><br><span class="line">WHERE t_department.&#96;dname&#96; &#x3D; &#39;教学部&#39; </span><br><span class="line"> AND t_department.&#96;did&#96; &#x3D; t_employee.&#96;dept_id&#96; </span><br><span class="line"> AND t_employee.ename &#x3D; &#39;孙红雷&#39;;</span><br><span class="line"></span><br><span class="line">#修改所有员工的领导编号为该员工所在部门的主管编号</span><br><span class="line">UPDATE t_employee,t_department </span><br><span class="line">SET t_employee.mid &#x3D; t_department.manager_id</span><br><span class="line">WHERE t_employee.dept_id &#x3D; t_department.did;</span><br><span class="line"></span><br><span class="line">#修改教学部的主管编号，以及该部门所有员工的领导编号为&quot;邓超&quot;的编号</span><br><span class="line">UPDATE t_department,t_employee</span><br><span class="line">SET t_department.manager_id &#x3D;t_employee.eid</span><br><span class="line">WHERE t_department.&#96;dname&#96; &#x3D; &#39;教学部&#39; </span><br><span class="line"> AND t_department.&#96;did&#96; &#x3D; t_employee.&#96;dept_id&#96; </span><br><span class="line"> AND t_employee.ename &#x3D; &#39;邓超&#39;;</span><br><span class="line"> </span><br><span class="line">UPDATE t_employee,t_department </span><br><span class="line">SET t_employee.mid &#x3D; t_department.manager_id</span><br><span class="line">WHERE t_employee.dept_id &#x3D; t_department.did</span><br><span class="line"> AND t_department.&#96;dname&#96; &#x3D; &#39;教学部&#39;;</span><br></pre></td></tr></table></figure>



<h2 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql30.png" alt="mysql"></p>
<h3 id="语法-2"><a href="#语法-2" class="headerlink" title="语法"></a>语法</h3><ul>
<li>delete from 表名 【where 条件】;</li>
<li>delete 表1，表2,…….  from 表1，表2，……  【where 条件】;</li>
</ul>
<h3 id="说明-2"><a href="#说明-2" class="headerlink" title="说明"></a>说明</h3><ol>
<li><p>如果不加where条件，表示删除整张表的数据，表结构保留。</p>
<p>delete from 表名;</p>
<p>删除整张表的数据还可以使用 truncate 表名;</p>
</li>
</ol>
<p>   区别：</p>
<p>   truncate相当于删除表再重建一张同名结构的表，操作后得到一张全新表，而delete是在原有表中删除数据。如果决定清空一张表的数据，truncate速度更快一些。</p>
<p>   TRUNCATE语句不能回滚</p>
<ol start="2">
<li><p>如果删除主表的记录，要注意查看从表的外键是否有依赖该行的值，如果有</p>
<ul>
<li>如果外键是on delete RESTRICT或on delete NO ACTION，那么要先处理从表的数据，才能删除</li>
<li>如果外键是on delete SET NULL 或 on delete CASCADE，那么删除时从表的对应记录也会被置空或跟着删除</li>
</ul>
</li>
<li><p>可以一次删除多个表的数据</p>
<p>例如：两个表没有建立外键，但逻辑上有外键关系，也可以通过删除多个表的数据来实现级联删除</p>
</li>
</ol>
<h3 id="示例-2"><a href="#示例-2" class="headerlink" title="示例"></a>示例</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#删除学号为9的学生信息</span><br><span class="line">DELETE FROM t_stu WHERE sid &#x3D; 9;</span><br><span class="line"></span><br><span class="line">#注意：前提是没有外键或外键是on delete cascade</span><br><span class="line">#删除所有“教学部”的员工信息和薪资信息和“教学部”部门信息</span><br><span class="line">DELETE t_employee,t_department,t_salary</span><br><span class="line">FROM t_employee,t_department,t_salary</span><br><span class="line">WHERE t_department.&#96;dname&#96; &#x3D;&#39;教学部&#39; </span><br><span class="line"> AND t_employee.&#96;dept_id&#96;&#x3D;t_department.&#96;did&#96;</span><br><span class="line"> AND t_employee.&#96;eid&#96; &#x3D; t_salary.eid;</span><br></pre></td></tr></table></figure>



<h2 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h2><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql31.png" alt="mysql"></p>
<h3 id="语法-3"><a href="#语法-3" class="headerlink" title="语法"></a>语法</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT 查询列表</span><br><span class="line">  FROM 表名或视图列表</span><br><span class="line">  【WHERE 条件表达式】</span><br><span class="line">  【GROUP BY 字段名 【HAVING 条件表达式】】</span><br><span class="line">  【ORDER BY 字段 【ASC|DESC】】</span><br><span class="line">  【LIMIT m,n】;</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#查询表中的所有行所有列</span><br><span class="line">#使用*表示，查询所有字段，即查询所有行</span><br><span class="line">select * from t_stu;</span><br><span class="line"></span><br><span class="line">#查询部分字段，查询部分列</span><br><span class="line">select sname,major from t_stu;</span><br><span class="line"></span><br><span class="line">#查询所有列，部分行</span><br><span class="line">select * from t_stu where major &#x3D; &#39;JavaEE&#39;;</span><br><span class="line"></span><br><span class="line">#查询部分行，部分列</span><br><span class="line">select sname,major from t_stu where major &#x3D; &#39;JavaEE&#39;;</span><br></pre></td></tr></table></figure>

<p>说明：</p>
<ol>
<li><p>如果SELECT后面是*，那么表示查询所有字段</p>
</li>
<li><p>SELECT后面的查询列表，可以是表中的字段，常量值，表达式，函数</p>
</li>
<li><p>查询的结果是一个虚拟的表</p>
</li>
<li><p>select语句，可以包含5种子句：依次是where、 group by、having、 order by、limit必须照这个顺序。</p>
</li>
</ol>
<h3 id="别名AS"><a href="#别名AS" class="headerlink" title="别名AS"></a><strong>别名AS</strong></h3><p>语法：AS 别名</p>
<p>说明：</p>
<ol>
<li><p>可以给字段取别名、可以给表名取别名</p>
</li>
<li><p>AS 可以省略</p>
</li>
<li><p>如果给字段取别名，如果别名中包含特殊符号，例如“空格”等，建议给别名加上双引号或单引号</p>
</li>
<li><p>如果是给表名取别名，那么不能加双引号或单引号，也不能有特殊符号，例如“空格”等</p>
</li>
<li><p>建议别名简短，见名知意</p>
</li>
</ol>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">UPDATE t_department AS d,t_employee AS e</span><br><span class="line">SET d.manager_id &#x3D;e.eid</span><br><span class="line">WHERE d.dname &#x3D; &#39;教学部&#39; </span><br><span class="line"> AND d.did &#x3D; e.&#96;dept_id&#96; </span><br><span class="line"> AND e.ename &#x3D; &#39;孙红雷&#39;;</span><br><span class="line"> </span><br><span class="line">#查询员工姓名以及手机号码</span><br><span class="line">SELECT ename AS &#39;员工姓名&#39;,tel AS &#39;手机号码&#39;</span><br><span class="line">FROM t_employee;</span><br></pre></td></tr></table></figure>



<h3 id="去重DISTINCT"><a href="#去重DISTINCT" class="headerlink" title="去重DISTINCT"></a>去重DISTINCT</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#查询员工表的部门编号</span><br><span class="line">SELECT DISTINCT dept_id FROM t_employee;</span><br><span class="line"></span><br><span class="line">#统计员工表中员工有几个部门</span><br><span class="line">SELECT COUNT(DISTINCT dept_id) FROM t_employee;</span><br></pre></td></tr></table></figure>



<h3 id="着重号"><a href="#着重号" class="headerlink" title="`着重号`"></a>`着重号`</h3><p>例如：select `name` from t_stu;</p>
<p>可以给字段或表名加着重号</p>
<p>如果字段名或表名与关键字一样更要加着重号了</p>
<h1 id="MySQL的运算符"><a href="#MySQL的运算符" class="headerlink" title="MySQL的运算符"></a>MySQL的运算符</h1><ol>
<li><p>算术运算符：+  -  *  /（除也可以写成div，div取整)  %（取模可以写成mod）</p>
</li>
<li><p>比较运算符：=  &gt;  &gt;=  &lt;  &lt;=  !=（不等于还可以写成&lt;&gt;） &lt;=&gt;（安全等于，用于判断null值）</p>
</li>
<li><p>逻辑运算符：&amp;&amp;（逻辑与也可以写成and） ||（逻辑或也可以写成or） not（逻辑非） xor（逻辑异或）</p>
</li>
<li><p>范围：表达式 between … and … （也可以写成 表达式&gt;=…  and 表达式 &lt;=…）</p>
<p>​            表达式 not between … and …（也可以写成 表达式&lt;…  || 表达式 &gt;…）</p>
</li>
<li><p>集合：in (值，值，值…)  not in(值，值，值…) </p>
</li>
<li><p>模糊查询：LIKE，  NOT  LIKE，通配符：%表示0-n个字符，_下划线代表一个字符</p>
</li>
<li><p>位运算符：&amp;（按位与） |（按位或）^（按位异或）~（按位取反）&gt;&gt;（右移）&lt;&lt;（左移）</p>
</li>
<li><p>NULL值判断，is null 或 is not null，如果使用null=null，null&lt;&gt;null,null=0,null&lt;&gt;0,null=false等都不对</p>
<p>不过xxx is null 可以使用xxx &lt;=&gt; null ，xxx  is not null 可以写成 not xxx &lt;=&gt; null</p>
<p>结论：所有的运算符遇到NULL结果都是NULL，除了&lt;=&gt;</p>
</li>
</ol>
<h2 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#一、算术运算符</span><br><span class="line">#+,-,*,&#x2F;(div),%(mod)</span><br><span class="line">#筛选出eid是偶数的员工</span><br><span class="line">SELECT * FROM t_employee WHERE eid % 2 &#x3D; 0; </span><br><span class="line">SELECT * FROM t_employee WHERE eid MOD 2 &#x3D; 0; </span><br><span class="line"></span><br><span class="line">#查看每天的基本工资值，每个月按22天算</span><br><span class="line">SELECT eid,basic_salary&#x2F;12 AS &quot;日薪&quot;</span><br><span class="line">FROM t_salary;</span><br><span class="line"></span><br><span class="line">#div也表示除，但是只保留整数部分</span><br><span class="line">SELECT eid,basic_salary DIV 12 AS &quot;日薪&quot;</span><br><span class="line">FROM t_salary;</span><br><span class="line"></span><br><span class="line">#关于+，在Java中，+的左右两边如果有字符串，那么表示字符串的拼接,但是在MySQL中+只表示数值相加，</span><br><span class="line">#如果遇到非数值类型，先尝试转成数值，如果转失败，就按0计算</span><br><span class="line">SELECT eid+ename FROM t_employee;</span><br><span class="line">SELECT eid+birthday FROM t_employee;</span><br><span class="line"></span><br><span class="line">#MySQL中字符串拼接要使用字符串函数实现</span><br><span class="line">SELECT CONCAT(eid,&quot;:&quot;,ename) AS result FROM t_employee;</span><br></pre></td></tr></table></figure>



<h2 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#二、比较运算符</span><br><span class="line">#&#x3D;，&gt;, &lt;，&gt;&#x3D;, &lt;&#x3D;， !&#x3D;(不等于&lt;&gt;)，&lt;&#x3D;&gt;（安全等于）</span><br><span class="line">#查询basic_salary!&#x3D;10000</span><br><span class="line">SELECT eid,basic_salary FROM t_salary WHERE basic_salary !&#x3D; 10000;</span><br><span class="line">SELECT eid,basic_salary FROM t_salary WHERE basic_salary &lt;&gt; 10000;</span><br><span class="line"></span><br><span class="line">#查询basic_salary&#x3D;10000，注意在Java中比较是&#x3D;&#x3D;</span><br><span class="line">SELECT eid,basic_salary FROM t_salary WHERE basic_salary &#x3D; 10000;</span><br><span class="line"></span><br><span class="line">#查询commission_pct等于0.40</span><br><span class="line">SELECT eid,commission_pct FROM t_salary WHERE commission_pct &#x3D; 0.40;</span><br><span class="line">SELECT eid,commission_pct FROM t_salary WHERE commission_pct &lt;&#x3D;&gt; 0.40;</span><br><span class="line"></span><br><span class="line">#查询commission_pct等于NULL</span><br><span class="line">SELECT eid,commission_pct FROM t_salary WHERE commission_pct IS NULL;</span><br><span class="line">SELECT eid,commission_pct FROM t_salary WHERE commission_pct &lt;&#x3D;&gt; NULL;</span><br><span class="line"></span><br><span class="line">#查询commission_pct不等于NULL</span><br><span class="line">SELECT eid,commission_pct FROM t_salary WHERE commission_pct IS NOT NULL;</span><br><span class="line">SELECT eid,commission_pct FROM t_salary WHERE NOT commission_pct &lt;&#x3D;&gt; NULL;</span><br></pre></td></tr></table></figure>



<h2 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#三、逻辑运算符</span><br><span class="line">#与&amp;&amp;，或||，非!</span><br><span class="line">#与 AND，或 OR ，非 NOT，异或 XOR</span><br><span class="line"></span><br><span class="line">#查询性别男，并且在90以前出生的员工</span><br><span class="line">SELECT * FROM t_employee WHERE gender&#x3D;&#39;男&#39; AND birthday&lt;&#39;1990-01-01&#39;; </span><br><span class="line"></span><br><span class="line">#查询职位编号job_id是1或2的员工</span><br><span class="line">SELECT * FROM t_employee WHERE job_id &#x3D;1 OR job_id &#x3D; 2;</span><br><span class="line"></span><br><span class="line">#查询基本薪资是在9000-12000之间的员工编号和基本薪资</span><br><span class="line">SELECT eid,basic_salary FROM t_salary WHERE basic_salary &gt;&#x3D;9000 AND basic_salary&lt;&#x3D;12000;</span><br><span class="line"></span><br><span class="line">#查询基本薪资不在9000-12000之间的员工编号和基本薪资</span><br><span class="line">SELECT eid,basic_salary FROM t_salary WHERE NOT (basic_salary &gt;&#x3D;9000 AND basic_salary&lt;&#x3D;12000);</span><br><span class="line">SELECT eid,basic_salary FROM t_salary WHERE basic_salary &lt;9000 OR basic_salary&gt;12000;</span><br></pre></td></tr></table></figure>



<h2 id="范围和集合"><a href="#范围和集合" class="headerlink" title="范围和集合"></a>范围和集合</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#四、表示区间范围和集合范围</span><br><span class="line">#between ... and ... 和 not between ... and ... </span><br><span class="line">#in(集合)  和 not in(...)</span><br><span class="line"></span><br><span class="line">#查询基本薪资是在9000-12000之间的员工编号和基本薪资</span><br><span class="line">SELECT eid,basic_salary FROM t_salary WHERE basic_salary BETWEEN 9000 AND 12000;</span><br><span class="line"></span><br><span class="line">#查询eid是1,3,5的基本工资</span><br><span class="line">SELECT eid,basic_salary FROM t_salary WHERE eid IN (1,3,5);</span><br></pre></td></tr></table></figure>



<h2 id="模糊查询"><a href="#模糊查询" class="headerlink" title="模糊查询"></a>模糊查询</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#五、模糊查询</span><br><span class="line">#like 和 通配符 一起使用</span><br><span class="line">#like _ 匹配单个字符</span><br><span class="line">#like % 匹配任意个字符</span><br><span class="line"></span><br><span class="line">#查询名字中有&#39;冰&#39;字的员工信息</span><br><span class="line">SELECT * FROM t_employee WHERE ename LIKE &#39;%冰%&#39;;</span><br><span class="line"></span><br><span class="line">#查询姓李的员工信息</span><br><span class="line">SELECT * FROM t_employee WHERE ename LIKE &#39;李%&#39;;</span><br><span class="line"></span><br><span class="line">#查询姓李，名字就一个字的员工信息</span><br><span class="line">SELECT * FROM t_employee WHERE ename LIKE &#39;李_&#39;;</span><br><span class="line"></span><br><span class="line">#查询李冰冰的信息</span><br><span class="line">SELECT * FROM t_employee WHERE ename LIKE &#39;李冰冰&#39;;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">通常情况，可以使用FIND_IN_SET()函数或LIKE操作符搜索SET值：</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM tbl_name WHERE FIND_IN_SET(&#39;value&#39;,set_col)&gt;0;</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM tbl_name WHERE set_col LIKE &#39;%value%&#39;;</span><br><span class="line"></span><br><span class="line">第1个语句找出SET_col包含value set成员的行。第2个类似，但有所不同：它在其它地方找出set_col包含value的行，甚至是在另一个SET成员的子字符串中。</span><br><span class="line"></span><br><span class="line">下面的语句也是合法的：</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM tbl_name WHERE set_col &amp; 1;</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM tbl_name WHERE set_col &#x3D; &#39;val1,val2&#39;;</span><br><span class="line"></span><br><span class="line">第1个语句寻找包含第1个set成员的值。第2个语句寻找一个确切匹配的值。应注意第2类的比较。将set值与&#39;val1,val2&#39;比较返回的结果与同&#39;val2,val1&#39;比较返回的结果不同。指定值时的顺序应与在列定义中所列的顺序相同。</span><br><span class="line"></span><br><span class="line">如果想要为SET列确定所有可能的值，使用SHOW COLUMNS FROM tbl_name LIKE set_col并解析输出中第2列的SET定义。</span><br><span class="line">有什么实际应用呢？</span><br><span class="line"></span><br><span class="line">比如我们设定用户的权限控制，一个用户可能会有多种权限，我们使用所有权限创建一个SET类型的字段，我们不需要用一系列int来定义各种权限了，直接使用一个SET字段即可：</span><br><span class="line"></span><br><span class="line">&#x2F;*</span><br><span class="line">用户权限permission表</span><br><span class="line">*&#x2F;</span><br><span class="line">create table user_permission(</span><br><span class="line">	id int UNSIGNED not null auto_increment,</span><br><span class="line">	user_id int not null ,</span><br><span class="line">	permission set(&#39;阅读&#39;,&#39;评论&#39;,&#39;发帖&#39;) not null,</span><br><span class="line">	primary key(id),</span><br><span class="line">	unique (user_id)</span><br><span class="line">);</span><br><span class="line">desc user_permission;</span><br><span class="line">insert into user_permission values (0,1,&#39;阅读&#39;),(0,2,&#39;阅读&#39;),(0,3,&#39;阅读,评论&#39;);</span><br><span class="line">insert into user_permission values (0,4,&#39;阅读,评论,发帖&#39;);</span><br><span class="line">select *,permission+0 from user_permission;</span><br><span class="line">select permission from user_permission where user_id&#x3D;1;</span><br><span class="line">select * from user_permission where permission &amp; 10;</span><br><span class="line">SELECT * FROM user_permission WHERE FIND_IN_SET(&#39;评论&#39;,permission)&gt;0;</span><br></pre></td></tr></table></figure>



<h2 id="NULL值判断与计算处理"><a href="#NULL值判断与计算处理" class="headerlink" title="NULL值判断与计算处理"></a>NULL值判断与计算处理</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#NULL值判断与处理</span><br><span class="line">#查询奖金百分比不为空的员工编号</span><br><span class="line">SELECT eid,commission_pct FROM t_salary WHERE commission_pct IS NOT NULL;</span><br><span class="line"></span><br><span class="line">#查询奖金百分比为空的员工编号</span><br><span class="line">SELECT eid,commission_pct FROM t_salary WHERE commission_pct IS NULL;</span><br><span class="line"></span><br><span class="line">#关于null值计算</span><br><span class="line">#所有运算符遇到null都是null</span><br><span class="line"></span><br><span class="line">#计算实际的薪资：  basic_salary + salary * 奖金百分比</span><br><span class="line">#函数：IFNULL(表达式,用什么值代替)</span><br><span class="line">SELECT eid,basic_salary + performance_salary *(1+ commission_pct) FROM t_salary;#错误的</span><br><span class="line">SELECT eid,basic_salary + performance_salary *(1+ IFNULL(commission_pct,0)) FROM t_salary;</span><br><span class="line"></span><br><span class="line">#&lt;&#x3D;&gt;安全等于</span><br><span class="line">#查询奖金百分比为空的员工编号</span><br><span class="line">SELECT eid,commission_pct FROM t_salary WHERE commission_pct &lt;&#x3D;&gt; NULL;</span><br></pre></td></tr></table></figure>



<h2 id="位运算符"><a href="#位运算符" class="headerlink" title="位运算符"></a>位运算符</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#七、位运算符</span><br><span class="line">#&gt;&gt; &lt;&lt; &amp; | ~  ^（异或）</span><br><span class="line">SELECT 2^3,2&amp;3,2|3,2&gt;&gt;3,2&lt;&lt;3,~3;</span><br></pre></td></tr></table></figure>



<h1 id="关联查询，联合查询"><a href="#关联查询，联合查询" class="headerlink" title="关联查询，联合查询"></a>关联查询，联合查询</h1><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql32.png" alt="mysql"></p>
<p>作用:从2张或多张表中,取出有关联的数据.</p>
<p>关联查询一共有几种情况：</p>
<ul>
<li>内连接：INNER JOIN 、CROSS JOIN</li>
<li>外连接：左外连接（LEFT OUTER JOIN）、右外连接（RIGHT OUTER JOIN）、全外连接（FULL OUTER JOIN）</li>
<li>自连接：当table1和table2本质上是同一张表，只是用取别名的方式虚拟成两张表以代表不同的意义</li>
</ul>
<p>说明：</p>
<ol>
<li><p>连接 n个表,至少需要 n-1个连接条件。 例如：连接三个表，至少需要两个连接条件。</p>
</li>
<li><p>当两个关联查询的表如果有字段名字相同，并且要查询中涉及该关联字段，那么需要使用表名前缀加以区分</p>
</li>
<li><p>当如果表名比较长时，可以给表取别名，简化SQL语句</p>
</li>
</ol>
<p>关联条件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT t_employee.eid,ename,basic_salary</span><br><span class="line">FROM t_employee, t_salary</span><br><span class="line">WHERE t_employee.eid &#x3D; t_salary.eid;</span><br></pre></td></tr></table></figure>

<p>表名前缀</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT t_employee.eid,ename,basic_salary</span><br><span class="line">FROM t_employee, t_salary</span><br><span class="line">WHERE t_employee.eid &#x3D; t_salary.eid;</span><br><span class="line">#否则报Column &#39;eid&#39; in field list is ambiguous</span><br></pre></td></tr></table></figure>

<p>表别名</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT emp.eid,ename,basic_salary</span><br><span class="line">FROM t_employee AS emp, t_salary AS s</span><br><span class="line">WHERE emp.eid &#x3D; s.eid;</span><br></pre></td></tr></table></figure>



<h2 id="笛卡尔积"><a href="#笛卡尔积" class="headerlink" title="笛卡尔积"></a>笛卡尔积</h2><p>定义：将两（或多）个表的所有行进行组合，连接后的行数为两（或多）个表的乘积数.</p>
<p>在MySQL中如下情况会出现笛卡尔积，主要是因为缺少关联条件或者关联条件不准确</p>
<p>注：外连接必须写关联条件，否则报语法错误</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#笛卡尔积</span><br><span class="line">#查询员工姓名和所在部门名称</span><br><span class="line">SELECT ename,dname FROM t_employee,t_department;</span><br><span class="line">SELECT ename,dname FROM t_employee INNER JOIN t_department;</span><br><span class="line">SELECT ename,dname FROM t_employee CROSS JOIN t_department;</span><br><span class="line">SELECT ename,dname FROM t_employee JOIN t_department;</span><br></pre></td></tr></table></figure>



<h2 id="关联条件"><a href="#关联条件" class="headerlink" title="关联条件"></a>关联条件</h2><p>表连接的约束条件可以有三种方式：WHERE, ON, USING</p>
<ul>
<li>WHERE：适用于所有关联查询</li>
<li>ON：只能和JOIN一起使用，只能写关联条件。虽然关联条件可以并到WHERE中和其他条件一起写，但分开写可读性更好。</li>
<li>USING：只能和JOIN一起使用，而且要求<strong>两个</strong>关联字段在关联表中名称一致，而且只能表示关联字段值相等</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#关联条件</span><br><span class="line">#把关联条件写在where后面</span><br><span class="line">SELECT ename,dname FROM t_employee,t_department WHERE t_employee.dept_id&#x3D;t_department.did;</span><br><span class="line"></span><br><span class="line">#把关联条件写在on后面，只能和JOIN一起使用</span><br><span class="line">SELECT ename,dname FROM t_employee INNER JOIN t_department ON t_employee.dept_id&#x3D;t_department.did;</span><br><span class="line">SELECT ename,dname FROM t_employee CROSS JOIN t_department ON t_employee.dept_id&#x3D;t_department.did;</span><br><span class="line">SELECT ename,dname FROM t_employee JOIN t_department ON t_employee.dept_id&#x3D;t_department.did;</span><br><span class="line"></span><br><span class="line">#把关联字段写在using()中，只能和JOIN一起使用</span><br><span class="line">#而且两个表中的关联字段必须名称相同，而且只能表示&#x3D;</span><br><span class="line">#查询员工姓名与基本工资</span><br><span class="line">SELECT ename,basic_salary FROM t_employee INNER JOIN t_salary USING(eid);</span><br><span class="line"></span><br><span class="line">#n张表关联，需要n-1个关联条件</span><br><span class="line">#查询员工姓名，基本工资，部门名称</span><br><span class="line">SELECT ename,basic_salary,dname FROM t_employee,t_department,t_salary </span><br><span class="line">WHERE t_employee.dept_id&#x3D;t_department.did AND t_employee.eid&#x3D;t_salary.eid;</span><br><span class="line"></span><br><span class="line">SELECT ename,basic_salary,dname FROM t_employee INNER JOIN t_department INNER JOIN t_salary </span><br><span class="line">ON t_employee.dept_id&#x3D;t_department.did AND t_employee.eid&#x3D;t_salary.eid;</span><br></pre></td></tr></table></figure>



<h2 id="内连接（INNER-JOIN）"><a href="#内连接（INNER-JOIN）" class="headerlink" title="内连接（INNER JOIN）"></a>内连接（INNER JOIN）</h2><p>有两种，显式的和隐式的，返回连接表中符合连接条件和查询条件的数据行</p>
<p>格式：</p>
<p><strong>隐式：</strong></p>
<ul>
<li>SELECT [cols_list] from 表1,表2  where [condition]</li>
</ul>
<p><strong>显式：</strong></p>
<ul>
<li><p>SELECT [cols_list] from 表1  INNER JOIN 表2  ON [关联条件] where [其他筛选条件]</p>
</li>
<li><p>SELECT [cols_list] from 表1  CROSS JOIN 表2  ON [关联条件] where [其他筛选条件]</p>
</li>
<li><p>SELECT [cols_list] from 表1  JOIN 表2  ON [关联条件] where [其他筛选条件]</p>
</li>
</ul>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql33.png" alt="mysql"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#内连接</span><br><span class="line">#查询员工姓名和所在部门名称</span><br><span class="line">SELECT ename,dname FROM t_employee,t_department WHERE t_employee.dept_id&#x3D;t_department.did;</span><br><span class="line">SELECT ename,dname FROM t_employee INNER JOIN t_department ON t_employee.dept_id&#x3D;t_department.did;</span><br><span class="line">SELECT ename,dname FROM t_employee CROSS JOIN t_department ON t_employee.dept_id&#x3D;t_department.did;</span><br><span class="line">SELECT ename,dname FROM t_employee JOIN t_department ON t_employee.dept_id&#x3D;t_department.did;</span><br><span class="line"></span><br><span class="line">#查询员工姓名，基本工资，部门名称</span><br><span class="line">SELECT ename,basic_salary,dname FROM t_employee,t_department,t_salary </span><br><span class="line">WHERE t_employee.dept_id&#x3D;t_department.did AND t_employee.eid&#x3D;t_salary.eid;</span><br><span class="line"></span><br><span class="line">SELECT ename,basic_salary,dname FROM t_employee INNER JOIN t_department INNER JOIN t_salary </span><br><span class="line">ON t_employee.dept_id&#x3D;t_department.did AND t_employee.eid&#x3D;t_salary.eid;</span><br></pre></td></tr></table></figure>

<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql34.png" alt="mysql"></p>
<h2 id="外连接（OUTER-JOIN）"><a href="#外连接（OUTER-JOIN）" class="headerlink" title="外连接（OUTER  JOIN）"></a>外连接（OUTER  JOIN）</h2><p>外连接分为：</p>
<p>左外连接（LEFT OUTER JOIN），简称左连接（LEFT JOIN）</p>
<p>右外连接（RIGHT OUTER JOIN），简称右连接（RIGHT JOIN）</p>
<p>全外连接（FULL OUTER JOIN），简称全连接（FULL JOIN）</p>
<h3 id="左连接（LEFT-JOIN）"><a href="#左连接（LEFT-JOIN）" class="headerlink" title="左连接（LEFT JOIN）"></a>左连接（LEFT JOIN）</h3><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql35.png" alt="mysql"></p>
<h3 id="右外连接（RIGHT-JOIN）"><a href="#右外连接（RIGHT-JOIN）" class="headerlink" title="右外连接（RIGHT JOIN）"></a>右外连接（RIGHT JOIN）</h3><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql36.png" alt="mysql"></p>
<h3 id="外连接（FULL-JOIN）"><a href="#外连接（FULL-JOIN）" class="headerlink" title="外连接（FULL JOIN）"></a>外连接（FULL JOIN）</h3><p>mysql不支持FULL JOIN，但是可以用 left join <strong>union</strong> right join代替</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql37.png" alt="mysql"></p>
<h2 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h2><p>当table1和table2本质上是同一张表，只是用取别名的方式虚拟成两张表以代表不同的意义。然后两个表再进行内连接，外连接等查询</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#自连接</span><br><span class="line">#查询员工姓名以及领导姓名，仅显示有领导的员工</span><br><span class="line">SELECT emp.ename,mgr.ename </span><br><span class="line">FROM t_employee AS emp, t_employee AS mgr</span><br><span class="line">WHERE emp.mid &#x3D; mgr.eid;</span><br><span class="line"></span><br><span class="line">#查询员工姓名以及领导姓名，仅显示有领导的员工</span><br><span class="line">SELECT emp.ename,mgr.ename </span><br><span class="line">FROM t_employee AS emp INNER JOIN t_employee AS mgr</span><br><span class="line">ON emp.mid &#x3D; mgr.eid;</span><br><span class="line"></span><br><span class="line">#查询所有员工姓名及其领导姓名</span><br><span class="line">SELECT emp.ename,mgr.ename </span><br><span class="line">FROM t_employee AS emp LEFT JOIN t_employee AS mgr</span><br><span class="line">ON emp.mid &#x3D; mgr.eid;</span><br></pre></td></tr></table></figure>



<h1 id="select的6个子句"><a href="#select的6个子句" class="headerlink" title="select的6个子句"></a>select的6个子句</h1><h2 id="from"><a href="#from" class="headerlink" title="from"></a>from</h2><p>后面跟表，视图，多行多列的二维表的结构</p>
<h2 id="where条件查询"><a href="#where条件查询" class="headerlink" title="where条件查询"></a>where条件查询</h2><p>从原表中的记录中进行筛选</p>
<h2 id="group-by-分组查询"><a href="#group-by-分组查询" class="headerlink" title="group by 分组查询"></a>group by 分组查询</h2><p>很多情况下，用户都需要进行一些汇总操作，比如统计整个公司的人数或者统计每一个部门的人数等。</p>
<h3 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h3><ul>
<li><p>AVG(【DISTINCT】 expr) 返回expr的平均值</p>
</li>
<li><p>COUNT（【DISTINCT】 expr）返回expr的非NULL值的数目</p>
</li>
<li><p>MIN(【DISTINCT】 expr)返回expr的最小值</p>
</li>
<li><p>MAX(【DISTINCT】 expr)返回expr的最大值</p>
</li>
<li><p>SUM（【DISTINCT】 expr）返回expr的总和</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#聚合函数</span><br><span class="line">#AVG(【DISTINCT】 expr) 返回expr的平均值</span><br><span class="line">SELECT AVG(basic_salary) FROM t_salary;</span><br><span class="line"></span><br><span class="line">#COUNT（【DISTINCT】 expr）返回expr的非NULL值的数目</span><br><span class="line">#统计员工总人数</span><br><span class="line">SELECT COUNT(*) FROM t_employee;#count(*)统计的是记录数</span><br><span class="line">#统计员工表的员工所在部门数</span><br><span class="line">SELECT COUNT(dept_id) FROM t_employee;#统计的是非NULL值</span><br><span class="line">SELECT COUNT(DISTINCT dept_id) FROM t_employee;#统计的是非NULL值，并且去重</span><br><span class="line"></span><br><span class="line">#MIN(【DISTINCT】 expr)返回expr的最小值</span><br><span class="line">#查询最低基本工资值</span><br><span class="line">SELECT MIN(basic_salary) FROM t_salary;</span><br><span class="line"></span><br><span class="line">#MAX(【DISTINCT】 expr)返回expr的最大值</span><br><span class="line">#查询最高基本工资值</span><br><span class="line">SELECT MAX(basic_salary) FROM t_salary;</span><br><span class="line"></span><br><span class="line">#查询最高基本工资与最低基本工资的差值</span><br><span class="line">SELECT MAX(basic_salary)-MIN(basic_salary) FROM t_salary;</span><br><span class="line"></span><br><span class="line">#SUM（【DISTINCT】 expr）返回expr的总和</span><br><span class="line">#查询基本工资总和</span><br><span class="line">SELECT SUM(basic_salary) FROM t_salary;</span><br></pre></td></tr></table></figure>



<h3 id="group-by-聚合函数"><a href="#group-by-聚合函数" class="headerlink" title="group by + 聚合函数"></a>group by + 聚合函数</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#group by + 聚合函数</span><br><span class="line">#统计每个部门的人数</span><br><span class="line">SELECT dept_id,COUNT(*) FROM t_employee</span><br><span class="line">GROUP BY dept_id;</span><br><span class="line"></span><br><span class="line">#统计每个部门的平均基本工资</span><br><span class="line">SELECT emp.dept_id,AVG(s.basic_salary )</span><br><span class="line">FROM t_employee AS emp,t_salary AS s</span><br><span class="line">WHERE emp.eid &#x3D; s.eid</span><br><span class="line">GROUP BY emp.dept_id;</span><br><span class="line"></span><br><span class="line">#统计每个部门的年龄最大者</span><br><span class="line">SELECT dept_id,MIN(birthday) FROM t_employee GROUP BY dept_id;</span><br><span class="line"></span><br><span class="line">#统计每个部门基本工资最高者</span><br><span class="line">SELECT emp.dept_id,MAX(s.basic_salary )</span><br><span class="line">FROM t_employee AS emp,t_salary AS s</span><br><span class="line">WHERE emp.eid &#x3D; s.eid</span><br><span class="line">GROUP BY emp.dept_id;</span><br><span class="line"></span><br><span class="line">#统计每个部门基本工资之和</span><br><span class="line">SELECT emp.dept_id,SUM(s.basic_salary )</span><br><span class="line">FROM t_employee AS emp,t_salary AS s</span><br><span class="line">WHERE emp.eid &#x3D; s.eid</span><br><span class="line">GROUP BY emp.dept_id;</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong></p>
<p>用count(*),count(1),谁好呢?</p>
<p>其实,对于myisam引擎的表,没有区别的.</p>
<p>这种引擎内部有一计数器在维护着行数.</p>
<p>Innodb的表,用count(*)直接读行数,效率很低,因为innodb真的要去数一遍.</p>
<p>关于mysql的group by的特殊：</p>
<p>注意：在SELECT 列表中所有未包含在组函数中的列都应该是包含在 GROUP BY 子句中的，换句话说，SELECT列表中最好不要出现GROUP BY子句中没有的列。</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql38.png" alt="mysql"></p>
<p>对于标准语句来说，这个语句是错误的，但是mysql可以这么干，出于可移植性和规范性,不推荐这么写。</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql39.png" alt="mysql"></p>
<h2 id="having-筛选"><a href="#having-筛选" class="headerlink" title="having 筛选"></a>having 筛选</h2><p>having与where类似,可筛选数据</p>
<p>having与where不同点</p>
<ul>
<li><p>where针对表中的列发挥作用,查询数据；having针对查询结果中的列发挥作用,筛选数据</p>
</li>
<li><p>where后面不能写分组函数，而having后面可以使用分组函数</p>
</li>
<li><p>having只用于group by分组统计语句</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#按照部门统计员工人数，仅显示部门人数少于3人的</span><br><span class="line">SELECT dept_id,COUNT(*) AS c </span><br><span class="line">FROM t_employee </span><br><span class="line">WHERE dept_id IS NOT NULL</span><br><span class="line">GROUP BY dept_id</span><br><span class="line">HAVING c &lt;3;</span><br><span class="line"></span><br><span class="line">#查询每个部门的平均工资，并且仅显示平均工资高于10000</span><br><span class="line">SELECT emp.dept_id,AVG(s.basic_salary ) AS avg_salary</span><br><span class="line">FROM t_employee AS emp,t_salary AS s</span><br><span class="line">WHERE emp.eid &#x3D; s.eid AND dept_id IS NOT NULL</span><br><span class="line">GROUP BY emp.dept_id</span><br><span class="line">HAVING avg_salary &gt;10000;</span><br></pre></td></tr></table></figure>



<h2 id="order-by-排序"><a href="#order-by-排序" class="headerlink" title="order by 排序"></a>order by 排序</h2><ul>
<li><p>按一个或多个字段对查询结果进行排序</p>
<p>用法：order by col1,col2,col3…</p>
<p>说明：先按col1排序如果col1相同就按照col2排序，依次类推</p>
<p>col1，col2，col3可以是select后面的字段也可以不是</p>
</li>
<li><p>默认是升序，也可以在字段后面加asc显示说明是升序，desc为降序</p>
<p>例如：order by click_count desc; </p>
<p>如果两个字段排序不一样，例如：order by 字段1 asc ,字段2 desc;</p>
</li>
<li><p>order by 后面除了跟1个或多个字段，还可以写表达式，函数，别名等</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#排序</span><br><span class="line">#查询员工基本工资，按照基本工资升序排列，如果工资相同，按照eid升序排列</span><br><span class="line">SELECT t_employee.eid,basic_salary FROM t_employee INNER JOIN t_salary</span><br><span class="line">ON t_employee.eid &#x3D; t_salary.eid</span><br><span class="line">ORDER BY basic_salary,eid;</span><br><span class="line"></span><br><span class="line">#查询员工基本工资，按照基本工资降序排列，如果工资相同，按照eid排列</span><br><span class="line">SELECT t_employee.eid,basic_salary FROM t_employee INNER JOIN t_salary</span><br><span class="line">ON t_employee.eid &#x3D; t_salary.eid</span><br><span class="line">ORDER BY basic_salary DESC,eid;</span><br><span class="line"></span><br><span class="line">#统计每个部门的平均基本工资，并按照平均工资降序排列</span><br><span class="line">SELECT emp.dept_id,AVG(s.basic_salary)</span><br><span class="line">FROM t_employee AS emp,t_salary AS s</span><br><span class="line">WHERE emp.eid &#x3D; s.eid</span><br><span class="line">GROUP BY emp.dept_id</span><br><span class="line">ORDER BY AVG(s.basic_salary) DESC;</span><br></pre></td></tr></table></figure>



<h2 id="limit-分页"><a href="#limit-分页" class="headerlink" title="limit 分页"></a>limit 分页</h2><p>limit m,n</p>
<p>m表示从下标为m的记录开始查询，第一条记录下标为0，n表示取出n条出来，如果从m开始不够n条了，就有几条取几条。m=(page-1)*n，（page页码，n表示每页显示的条数）</p>
<p>如果第一页limit 0,n</p>
<p>如果第二页limit n,n</p>
<p>依次类推，得出公式limit  (page-1)*n , n</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#分页</span><br><span class="line">#查询员工信息，每页显示5条，第二页</span><br><span class="line">SELECT * FROM t_employee LIMIT 5,5;</span><br><span class="line"></span><br><span class="line">#统计每个部门的平均基本工资，并显示前三名</span><br><span class="line">SELECT emp.dept_id,AVG(s.basic_salary)</span><br><span class="line">FROM t_employee AS emp,t_salary AS s</span><br><span class="line">WHERE emp.eid &#x3D; s.eid</span><br><span class="line">GROUP BY emp.dept_id</span><br><span class="line">ORDER BY AVG(s.basic_salary) DESC</span><br><span class="line">LIMIT 0,3;</span><br></pre></td></tr></table></figure>



<h1 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h1><p>某些情况下，当进行一个查询时，需要的条件或数据要用另外一个 select 语句的结果，这个时候，就要用到子查询。</p>
<p>例如：</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql40.png" alt="mysql"></p>
<p>为了给主查询（外部查询）提供数据而首先执行的查询（内部查询）被叫做子查询。</p>
<p>一般根据子查询的嵌入位置分为，where型子查询,from型子查询，exists型子查询。</p>
<h2 id="where型子查询"><a href="#where型子查询" class="headerlink" title="where型子查询"></a>where型子查询</h2><p>where型子查询即把内层sql语句查询的结果作为外层sql查询的条件.</p>
<ul>
<li>子查询要包含在括号内。</li>
<li>建议将子查询放在比较条件的右侧。</li>
<li>单行操作符对应单行子查询，多行操作符对应多行子查询。<ul>
<li>单行操作符 右边子查询必须返回的是<strong>单个值</strong>，单行比较运算符（=,&gt;,&gt;=,&lt;,&lt;=,&lt;&gt;）</li>
<li>多行操作符 右边子查询可以返回多行，但必须是单列，ALL, ANY,IN 其中，ALL和ANY运算符必须与单行比较运算符（=,&gt;,&gt;=,&lt;,&lt;=,&lt;&gt;）结合使用</li>
</ul>
</li>
</ul>
<blockquote>
<p>IN：等于任何一个</p>
<p>ALL：和子查询返回的所有值比较。例如：sal&gt;ALL(1,2,3)等价于sal&gt;1 &amp;&amp; sal&gt;2 &amp;&amp; sal&gt;3，即大于所有。</p>
<p>ANY：和子查询返回的任意一个值比较。例如：sal&gt;ANY(1,2,3)等价于sal&gt;1 or sal&gt;2 or sal&gt;3，即大于任意一个就可以。</p>
<p>EXISTS：判断子查询是否有返回结果（不关心具体行数和内容），如果返回则为TRUE，否则为FALSE。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#子查询</span><br><span class="line">#where型子查询</span><br><span class="line">#查询比“孙红雷”的工资高的员工编号</span><br><span class="line">SELECT * FROM t_salary</span><br><span class="line">WHERE basic_salary &gt; (SELECT basic_salary FROM t_employee INNER JOIN t_salary ON t_employee.eid&#x3D;t_salary.eid WHERE t_employee.ename&#x3D;&#39;孙红雷&#39;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#查询和孙红雷，李晨在同一个部门的员工</span><br><span class="line">SELECT * FROM t_employee</span><br><span class="line">WHERE dept_id IN(SELECT dept_id FROM t_employee WHERE ename&#x3D;&#39;孙红雷&#39; OR ename &#x3D; &#39;李晨&#39;);</span><br><span class="line"></span><br><span class="line">SELECT * FROM t_employee</span><br><span class="line">WHERE dept_id &#x3D; ANY(SELECT dept_id FROM t_employee WHERE ename&#x3D;&#39;孙红雷&#39; OR ename &#x3D; &#39;李晨&#39;);</span><br><span class="line"></span><br><span class="line">#查询全公司工资最高的员工编号，基本工资</span><br><span class="line">SELECT eid,basic_salary FROM t_salary</span><br><span class="line">WHERE basic_salary &#x3D; (SELECT MAX(basic_salary) FROM t_salary);</span><br><span class="line"></span><br><span class="line">SELECT eid,basic_salary FROM t_salary</span><br><span class="line">WHERE basic_salary &gt;&#x3D; ALL(SELECT basic_salary FROM t_salary);</span><br></pre></td></tr></table></figure>



<h2 id="from型子查询"><a href="#from型子查询" class="headerlink" title="from型子查询"></a>from型子查询</h2><p>from型子查询即把内层sql语句查询的结果作为临时表供外层sql语句再次查询.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#from型</span><br><span class="line">#找出比部门平均工资高的员工编号，基本工资</span><br><span class="line">SELECT t_employee.eid,basic_salary </span><br><span class="line">FROM t_salary INNER JOIN t_employee INNER JOIN (</span><br><span class="line">	SELECT emp.dept_id AS did,AVG(s.basic_salary) AS avg_salary</span><br><span class="line">	FROM t_employee AS emp,t_salary AS s</span><br><span class="line">	WHERE emp.eid &#x3D; s.eid</span><br><span class="line">	GROUP BY emp.dept_id) AS temp</span><br><span class="line">ON t_salary.eid &#x3D; t_employee.eid AND t_employee.dept_id &#x3D; temp.did</span><br><span class="line">WHERE t_salary.basic_salary &gt; temp.avg_salary;</span><br></pre></td></tr></table></figure>



<h2 id="exists型子查询"><a href="#exists型子查询" class="headerlink" title="exists型子查询"></a>exists型子查询</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#exists型</span><br><span class="line">#查询部门信息，该部门必须有员工</span><br><span class="line">SELECT * FROM t_department </span><br><span class="line">WHERE EXISTS (SELECT * FROM t_employee WHERE t_employee.dept_id &#x3D; t_department.did);</span><br></pre></td></tr></table></figure>



<h2 id="复制表子查询"><a href="#复制表子查询" class="headerlink" title="复制表子查询"></a>复制表子查询</h2><h3 id="复制表"><a href="#复制表" class="headerlink" title="复制表"></a>复制表</h3><ol>
<li><p>拷贝表结构</p>
<p>CREATE TABLE newadmin LIKE admin;</p>
</li>
<li><p>拷贝表结构和数据（但约束与索引除外）</p>
<p>CREATE TABLE newadmin  AS  ( SELECT *  FROM admin  )  ;</p>
</li>
<li><p>拷贝表结构+数据</p>
<p>CREATE TABLE newadmin LIKE admin;  </p>
<p>INSERT INTO newadmin SELECT * FROM admin;</p>
</li>
<li><p>跨数据库拷贝表</p>
<p>CREATE TABLE newadmin LIKE shop.admin;  </p>
<p>CREATE TABLE newshop.newadmin LIKE shop.admin; </p>
</li>
<li><p>拷贝一个表中其中的一些字段（指定新名），其中一些数据</p>
<p>CREATE TABLE newadmin AS  (  </p>
<p>​        SELECT id, username AS uname, password AS pass FROM admin  WHERE id&lt;10 </p>
<p>)  ;</p>
</li>
<li><p>在创建表的同时定义表中的字段信息。</p>
<p>create table tt    (</p>
<p>​    eid int primary key auto_increment</p>
<p>)    as    (</p>
<p>​    select employee_id as eid,first_name,last_name,email from employees</p>
<p>); </p>
</li>
</ol>
<h3 id="复制数据"><a href="#复制数据" class="headerlink" title="复制数据"></a>复制数据</h3><p>在 INSERT 语句中加入子查询。</p>
<p>不必书写 VALUES 子句。 </p>
<p>子查询中的值列表应与 INSERT 子句中的列名对应。</p>
<p>INSERT INTO emp2 </p>
<p>SELECT * FROM employees WHERE department_id = 90;</p>
<p>或</p>
<p>INSERT INTO sales_reps(id, name, salary, commission_pct)</p>
<p>SELECT employee_id, last_name, salary, commission_pct</p>
<p>FROM  employees</p>
<p>WHERE  job_id LIKE ‘%REP%’;</p>
<h1 id="单行函数"><a href="#单行函数" class="headerlink" title="单行函数"></a>单行函数</h1><p>MySQL数据库提供了很多函数包括：</p>
<ul>
<li><p>数学函数；</p>
</li>
<li><p>字符串函数；</p>
</li>
<li><p>日期和时间函数；</p>
</li>
<li><p>条件判断函数；流程控制函数；</p>
</li>
<li><p>系统信息函数；</p>
</li>
<li><p>加密函数；</p>
</li>
<li><p>格式化函数；</p>
</li>
</ul>
<h2 id="数学函数"><a href="#数学函数" class="headerlink" title="数学函数"></a>数学函数</h2><table>
<thead>
<tr>
<th>ABS（x）</th>
<th>返回x的绝对值</th>
</tr>
</thead>
<tbody><tr>
<td>CEIL（x）</td>
<td>返回大于x的最小整数值</td>
</tr>
<tr>
<td>FLOOR（x）</td>
<td>返回大于x的最大整数值</td>
</tr>
<tr>
<td>MOD(x,y)</td>
<td>返回x/y的模</td>
</tr>
<tr>
<td>RAND(x)</td>
<td>返回0~1的随机值</td>
</tr>
<tr>
<td>ROUND(x,y)</td>
<td>返回参数x的四舍五入的有y位的小数的值</td>
</tr>
<tr>
<td>TRUNCATE(x,y)</td>
<td>返回数字x截断为y位小数的结果</td>
</tr>
<tr>
<td>SQRT(x)</td>
<td>返回x的平方根</td>
</tr>
<tr>
<td>POW(x,y)</td>
<td>返回x的y次方</td>
</tr>
</tbody></table>
<h2 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h2><table>
<thead>
<tr>
<th>CONCAT(S1,S2,……,Sn)</th>
<th>连接S1,S2,……,Sn为一个字符串</th>
</tr>
</thead>
<tbody><tr>
<td>CONCAT_WS(s, S1,S2,……,Sn)</td>
<td>同CONCAT(s1,s2,…)函数，但是每个字符串之间要加上s</td>
</tr>
<tr>
<td>CHAR_LENGTH(s)</td>
<td>返回字符串s的字符数</td>
</tr>
<tr>
<td>LENGTH(s)</td>
<td>返回字符串s的字节数，和字符集有关</td>
</tr>
<tr>
<td>INSERT(str, index , len, instr)</td>
<td>将字符串str从第index位置开始，len个字符长的子串替换为字符串instr</td>
</tr>
<tr>
<td>UPPER(s) 或 UCASE(s)</td>
<td>将字符串s的所有字母转成大写字母</td>
</tr>
<tr>
<td>LOWER(s)  或LCASE(s)</td>
<td>将字符串s的所有字母转成小写字母</td>
</tr>
<tr>
<td>LEFT(s,n)</td>
<td>返回字符串s最左边的n个字符</td>
</tr>
<tr>
<td>RIGHT(s,n)</td>
<td>返回字符串s最右边的n个字符</td>
</tr>
<tr>
<td>LPAD(str, len, pad)</td>
<td>用字符串pad对str最左边进行填充，直到str的长度为len个字符</td>
</tr>
<tr>
<td>RPAD(str ,len, pad)</td>
<td>用字符串pad对str最右边进行填充，直到str的长度为len个字符</td>
</tr>
<tr>
<td>LTRIM(s)</td>
<td>去掉字符串s左侧的空格</td>
</tr>
<tr>
<td>RTRIM(s)</td>
<td>去掉字符串s右侧的空格</td>
</tr>
<tr>
<td>TRIM(s)</td>
<td>去掉字符串s开始与结尾的空格</td>
</tr>
<tr>
<td>TRIM(【BOTH 】s1 FROM s)</td>
<td>去掉字符串s开始与结尾的s1</td>
</tr>
<tr>
<td>TRIM(【LEADING】s1 FROM s)</td>
<td>去掉字符串s开始处的s1</td>
</tr>
<tr>
<td>TRIM(【TRAILING】s1 FROM s)</td>
<td>去掉字符串s结尾处的s1</td>
</tr>
<tr>
<td>REPEAT(str, n)</td>
<td>返回str重复n次的结果</td>
</tr>
<tr>
<td>REPLACE（str, a, b）</td>
<td>用字符串b替换字符串str中所有出现的字符串a</td>
</tr>
<tr>
<td>STRCMP(s1,s2)</td>
<td>比较字符串s1,s2</td>
</tr>
<tr>
<td>SUBSTRING(s,index,len)</td>
<td>返回从字符串s的index位置其len个字符</td>
</tr>
</tbody></table>
<h2 id="日期时间函数"><a href="#日期时间函数" class="headerlink" title="日期时间函数"></a>日期时间函数</h2><table>
<thead>
<tr>
<th>CURDATE() 或 CURRENT_DATE()</th>
<th>返回当前日期</th>
</tr>
</thead>
<tbody><tr>
<td>CURTIME() 或 CURRENT_TIME()</td>
<td>返回当前时间</td>
</tr>
<tr>
<td>NOW() <br />SYSDATE()<br />CURRENT_TIMESTAMP()<br />LOCALTIME()<br />LOCALTIMESTAMP()</td>
<td>返回当前系统日期时间</td>
</tr>
<tr>
<td>YEAR(date)<br />MONTH(date)<br />DAY(date)<br />HOUR(time)<br />MINUTE(time)<br />SECOND(time)</td>
<td>返回具体的时间值</td>
</tr>
<tr>
<td>WEEK(date)<br />WEEKOFYEAR(date)</td>
<td>返回一年中的第几周</td>
</tr>
<tr>
<td>DAYOFWEEK()</td>
<td>返回周几，注意：周日是1，周一是2，。。。周六是7</td>
</tr>
<tr>
<td>WEEKDAY(date)</td>
<td>返回周几，注意，周1是0，周2是1，。。。周日是6</td>
</tr>
<tr>
<td>DAYNAME(date)</td>
<td>返回星期：MONDAY,TUESDAY…..SUNDAY</td>
</tr>
<tr>
<td>MONTHNAME(date)</td>
<td>返回月份：January，。。。。。</td>
</tr>
<tr>
<td>DATEDIFF(date1,date2)<br />TIMEDIFF(time1, time2)</td>
<td>返回date1 - date2的日期间隔返回time1 - time2的时间间隔</td>
</tr>
<tr>
<td>DATE_ADD(datetime, INTERVALE  expr  type)</td>
<td>返回与给定日期时间相差INTERVAL时间段的日期时间</td>
</tr>
<tr>
<td>DATE_FORMAT(datetime ,fmt)</td>
<td>按照字符串fmt格式化日期datetime值</td>
</tr>
<tr>
<td>STR_TO_DATE(str, fmt)</td>
<td>按照字符串fmt对str进行解析，解析为一个日期</td>
</tr>
</tbody></table>
<ul>
<li>DATE_ADD(datetime,INTERVAL  expr  type</li>
</ul>
<blockquote>
<p>SELECT DATE_ADD(NOW(), INTERVAL 1 YEAR);</p>
<p>SELECT DATE_ADD(NOW(), INTERVAL -1 YEAR);  #可以是负数</p>
<p>SELECT DATE_ADD(NOW(), INTERVAL ‘1_1’ YEAR_MONTH);  #需要单引号</p>
</blockquote>
<table>
<thead>
<tr>
<th>表达式类型</th>
<th>YEAR_MONTH</th>
</tr>
</thead>
<tbody><tr>
<td>YEAR</td>
<td>DAY_HOUR</td>
</tr>
<tr>
<td>MONTH</td>
<td>DAY_MINUTE</td>
</tr>
<tr>
<td>DAY</td>
<td>DAY_SECOND</td>
</tr>
<tr>
<td>HOUR</td>
<td>HOUR_MINUTE</td>
</tr>
<tr>
<td>MINUTE</td>
<td>HOUR_SECOND</td>
</tr>
<tr>
<td>SECOND</td>
<td>MINUTE_SECOND</td>
</tr>
</tbody></table>
<ul>
<li>DATE_FORMAT(datetime ,fmt)和STR_TO_DATE(str, fmt)</li>
</ul>
<table>
<thead>
<tr>
<th>格式符</th>
<th>说明</th>
<th>格式符</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>%Y</td>
<td>4位数字表示年份</td>
<td>%y</td>
<td>表示两位数字表示年份</td>
</tr>
<tr>
<td>%M</td>
<td>月名表示月份（January,….）</td>
<td>%m</td>
<td>两位数字表示月份（01,02,03。。。）</td>
</tr>
<tr>
<td>%b</td>
<td>缩写的月名（Jan.，Feb.，….）</td>
<td>%c</td>
<td>数字表示月份（1,2,3,…）</td>
</tr>
<tr>
<td>%D</td>
<td>英文后缀表示月中的天数（1st,2nd,3rd,…）</td>
<td>%d</td>
<td>两位数字表示月中的天数(01,02…)</td>
</tr>
<tr>
<td>%e</td>
<td>数字形式表示月中的天数（1,2,3,4,5…..）</td>
<td></td>
<td></td>
</tr>
<tr>
<td>%H</td>
<td>两位数字表示小数，24小时制（01,02..）</td>
<td>%h和%I</td>
<td>两位数字表示小时，12小时制（01,02..）</td>
</tr>
<tr>
<td>%k</td>
<td>数字形式的小时，24小时制(1,2,3)</td>
<td>%l</td>
<td>数字形式表示小时，12小时制（1,2,3,4….）</td>
</tr>
<tr>
<td>%i</td>
<td>两位数字表示分钟（00,01,02）</td>
<td>%S和%s</td>
<td>两位数字表示秒(00,01,02…)</td>
</tr>
<tr>
<td>%W</td>
<td>一周中的星期名称（Sunday…）</td>
<td>%a</td>
<td>一周中的星期缩写（Sun.，Mon.,Tues.，..）</td>
</tr>
<tr>
<td>%w</td>
<td>以数字表示周中的天数(0=Sunday,1=Monday….)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>%j</td>
<td>以3位数字表示年中的天数(001,002…)</td>
<td>%U</td>
<td>以数字表示年中的第几周，（1,2,3。。）其中Sunday为周中第一天</td>
</tr>
<tr>
<td>%u</td>
<td>以数字表示年中的第几周，（1,2,3。。）其中Monday为周中第一天</td>
<td></td>
<td></td>
</tr>
<tr>
<td>%T</td>
<td>24小时制</td>
<td>%r</td>
<td>12小时制</td>
</tr>
<tr>
<td>%p</td>
<td>AM或PM</td>
<td>%%</td>
<td>表示%</td>
</tr>
</tbody></table>
<h2 id="流程函数"><a href="#流程函数" class="headerlink" title="流程函数"></a>流程函数</h2><table>
<thead>
<tr>
<th>IF(value,t ,f)</th>
<th>如果value是真，返回t，否则返回f</th>
</tr>
</thead>
<tbody><tr>
<td>IFNULL(value1, value2)</td>
<td>如果value1不为空，返回value1，否则返回value2</td>
</tr>
<tr>
<td>CASE <br />WHEN 条件1 THEN <br />result1 <br />WHEN 条件2 THEN <br />result2<br />….<br />[ELSE resultn]<br />END</td>
<td>相当于Java的if…else if…</td>
</tr>
<tr>
<td>CASE  expr <br />WHEN 常量值1 THEN 值1<br />WHEN 常量值1 THEN 值1<br />….<br />[ELSE 值n]<br />END</td>
<td>相当于Java的switch</td>
</tr>
<tr>
<td></td>
<td>SELECT ename ,CASE <br />WHEN salary&gt;=15000 THEN ‘高薪’<br />WHEN salary&gt;=10000 THEN ‘潜力股’<br />WHEN salary&gt;=8000 THEN ‘屌丝’<br />ELSE ‘草根’<br />ENDFROM t_employee;</td>
</tr>
<tr>
<td></td>
<td>SELECT oid,`status`, CASE `status`<br />WHEN 1 THEN ‘未付款’<br />WHEN 2 THEN ‘已付款’<br />WHEN 3 THEN ‘已发货’<br />WHEN 4 THEN ‘确认收货’<br />ELSE ‘无效订单’<br />END<br />FROM t_order;</td>
</tr>
</tbody></table>
<h2 id="其他函数"><a href="#其他函数" class="headerlink" title="其他函数"></a>其他函数</h2><table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>database()</td>
<td>返回当前数据库名</td>
</tr>
<tr>
<td>version()</td>
<td>返回当前数据库版本</td>
</tr>
<tr>
<td>user()</td>
<td>返回当前登录用户名</td>
</tr>
<tr>
<td>password(str)</td>
<td>返回字符串str的加密版本，41位长的字符串</td>
</tr>
<tr>
<td>md5(str)</td>
<td>返回字符串str的md5值，也是一种加密方式</td>
</tr>
</tbody></table>
<h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><p>DCL用来控制数据库的访问，包括如下SQL语句：</p>
<ul>
<li>GRANT：授予访问权限</li>
<li>REVOKE：撤销访问权限</li>
<li>COMMIT：提交事务处理</li>
<li>ROLLBACK：事务处理回退</li>
<li>SAVEPOINT：设置保存点</li>
<li>LOCK：对数据库的特定部分进行锁定</li>
</ul>
<p>思考：我去银行给朋友汇款,我卡上有1000元,朋友卡上500元,我给朋友转账50元(无手续费),如果,我的钱刚扣,而朋友的钱又没加时,网线断了,怎么办?</p>
<h2 id="事务的ACID特性"><a href="#事务的ACID特性" class="headerlink" title="事务的ACID特性"></a>事务的ACID特性</h2><ul>
<li><p>原子性(Atomicity)：原子意为最小的粒子，或者说不能再分的事物。数据库事务的不可再分的原则即为原子性。 </p>
<p>组成事务的所有SQL必须：要么全部执行，要么全部取消（就像上面的银行例子）。</p>
</li>
<li><p>一致性(Consistency)：指数据的规则,在事务前/</p>
</li>
<li><p>隔离性(Isolation)：简单点说，某个事务的操作对其他事务不可见的.</p>
</li>
<li><p>持久性(Durability)：当事务提交完成后，其影响应该保留下来，不能撤消</p>
</li>
</ul>
<h2 id="事务的用法"><a href="#事务的用法" class="headerlink" title="事务的用法"></a>事务的用法</h2><ul>
<li>开启事务(start transaction)</li>
<li>执行sql操作(普通sql操作)</li>
<li>提交/回滚(commit/rollback)</li>
</ul>
<p>注意:</p>
<ul>
<li>建表的时候,选择 <strong>Innodb引擎</strong>才支持事务</li>
<li>默认情况下，MySQL是自动提交事务，每次执行一个 SQL 语句时，如果执行成功，就会向数据库自动提交，而不能回滚。如果某一组操作需要在一个事务中，那么需要使用start transaction，一旦rollback或commit就结束当次事务，之后的操作又自动提交。</li>
<li>如果需要在当前会话（连接）的整个过程中都取消自动提交事务，进行手动提交事务，就需要设置set autocommit = false;或set autocommit = 0;那样的话每一句SQL都需要手动commit提交才会真正生效。rollback或commit之前的所有操作都视为一个事务，之后的操作视为另一个事务，还需要手动提交或回滚。</li>
<li>和Oracle一样，DDL语句是不能回滚的，并且部分的DDL语句会造成隐式的提交，因此最好事务中不要涉及DDL语句。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#开启手动处理事务模式</span><br><span class="line">#set autocommit &#x3D; false;</span><br><span class="line">#开始事务（推荐）</span><br><span class="line">start transaction;</span><br><span class="line"></span><br><span class="line">#查看当前表的数据</span><br><span class="line">select * from t_stu_detail;</span><br><span class="line">#删除整张表的数据</span><br><span class="line">delete from t_stu_detail;</span><br><span class="line">#查询该表数据，发现显示删除后的结果</span><br><span class="line">select * from t_stu_detail;</span><br><span class="line">#回滚</span><br><span class="line">rollback</span><br><span class="line">#查看当前表的数据，发现又回来了</span><br><span class="line">select * from t_stu_detail;</span><br><span class="line"></span><br><span class="line">#删除整张表的数据</span><br><span class="line">delete from t_stu_detail;</span><br><span class="line">#提交事务</span><br><span class="line">commit;</span><br><span class="line">#查看当前表的数据，发现真删除了</span><br><span class="line">select * from t_stu_detail;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#插入一条记录</span><br><span class="line">INSERT INTO t_stu_detail VALUES </span><br><span class="line">(1, &#39;123456789012345678&#39;, &#39;1990-01-21&#39;, &#39;12345678901&#39;, &#39;a@163.com&#39;, &#39;北七家&#39;);</span><br><span class="line">#保存还原点1</span><br><span class="line">savepoint point1;</span><br><span class="line">#插入一条记录</span><br><span class="line"></span><br><span class="line">INSERT INTO t_stu_detail VALUES </span><br><span class="line">(2, &#39;123456789012345677&#39;, &#39;1990-02-21&#39;, &#39;12345678902&#39;, &#39;b@163.com&#39;, &#39;北七家&#39;);</span><br><span class="line">#保存还原点2</span><br><span class="line">savepoint point2;</span><br><span class="line"></span><br><span class="line">#查看当前效果</span><br><span class="line">select * from t_stu_detail;</span><br><span class="line"></span><br><span class="line">#回滚到某个还原点</span><br><span class="line">rollback to point1;</span><br><span class="line"></span><br><span class="line">#提交事务</span><br><span class="line">commit;</span><br><span class="line"></span><br><span class="line">#清空表</span><br><span class="line">truncate t_stu_detail;</span><br><span class="line">#回滚，对于truncate无法回滚</span><br><span class="line">rollback;</span><br><span class="line">#修改表结构</span><br><span class="line">alter table t_stu_detail add description varchar(50);</span><br><span class="line">#回滚，对于修改表结构的语句无法回滚</span><br><span class="line">rollback;</span><br></pre></td></tr></table></figure>



<h2 id="数据库的隔离级别"><a href="#数据库的隔离级别" class="headerlink" title="数据库的隔离级别"></a>数据库的隔离级别</h2><p>对于同时运行的多个事务（<strong>多线程并发</strong>）, 当这些事务访问数据库中相同的数据时, 如果没有采取必要的隔离机制, 就会导致各种并发问题: （问题的本质就是线程安全问题，共享数据的问题）</p>
<ul>
<li><p>脏读: </p>
<p>对于两个事务 T1, T2, T1 读取了已经被 T2 更新但还<strong>没有被提交</strong>的字段. 之后, 若 T2 <strong>回滚</strong>, T1读取的内容就是临时且无效的.</p>
</li>
<li><p>不可重复读：</p>
<p>对于两个事务 T1, T2, T1 读取了一个字段, 然后 T2 <strong>更新并提交</strong>了该字段. 之后, T1再次读取同一个字段, 值就不同了.</p>
</li>
<li><p>幻读：</p>
<p>对于两个事务 T1, T2, T1 从一个表中读取了一个字段, 然后 T2 在该表中<strong>插入、删除</strong>了一些新的行. 之后, 如果 T1 再次读取同一个表, 就会<strong>多出、少了</strong>几行.</p>
</li>
</ul>
<p>数据库事务的隔离性: 数据库系统必须具有隔离并发运行各个事务的能力, 使它们不会相互影响, 避免各种并发问题。一个事务与其他事务隔离的程度称为隔离级别. 数据库规定了多种事务隔离级别, 不同隔离级别对应不同的干扰程度, 隔离级别越高, 数据一致性就越好, 但并发性越弱。</p>
<p>Oracle 支持的 2 种事务隔离级别：READ COMMITED, SERIALIZABLE. Oracle 默认的事务隔离级别为: READ COMMITED </p>
<p>Mysql 支持 4 中事务隔离级别. Mysql 默认的事务隔离级别为: REPEATABLE-READ</p>
<p>每启动一个 mysql 程序, 就会获得一个单独的数据库连接. 每个数据库连接都有一个变量 @@tx_isolation, 表示当前的事务隔离级别. </p>
<ul>
<li>SELECT @@tx_isolation;    查看当前的隔离级别</li>
<li>select @@global.tx_isolation;    查看全局的隔离级别</li>
<li>set tx_isolation =’repeatable-read’;    设置当前 mySQL 连接的隔离级别</li>
<li>set global tx_isolation =’read-committed’;    设置数据库系统的全局的隔离级别</li>
</ul>
<table>
<thead>
<tr>
<th>隔离级别</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>READ-UNCOMMITTED</td>
<td>允许事务读取其他事务未提交的数据，脏读、不可重复读、幻读的问题都会出现</td>
</tr>
<tr>
<td>READ-COMMITTED</td>
<td>只允许事务读取其他事务已经提交的数据，可以避免脏读，但是不可重复读、幻读的问题仍然会出现</td>
</tr>
<tr>
<td>REPEATABLE-READ</td>
<td>确保事务可以多次从一个字段中读取相同的值，好比在事务开启时对现有的数据进行了拍照，其他事务对数据的修改，不管事务是否提交，我这里读取的是拍照下来的数据，可以避免脏读和不可重复读，但幻读的问题仍然存在。注意：INNODB使用了MVCC (Multiversion Concurrency Control)，即多版本并发控制技术防止幻读。真正的像拍照一样，其他事务新插入或删除的记录也看不出来。</td>
</tr>
<tr>
<td>SERIALIZABLE</td>
<td>确保事务可以从一个表中读取相同的行，在这个事务持续期间，禁止其他事务对该表执行插入、更新、删除操作，所有并发问题都可以避免，但是性能十分低下。</td>
</tr>
</tbody></table>
<h2 id="示例演示"><a href="#示例演示" class="headerlink" title="示例演示"></a>示例演示</h2><h3 id="脏读"><a href="#脏读" class="headerlink" title="脏读"></a>脏读</h3><p>脏读：进入餐厅发现“梦中情人”旁边座位已经有“帅哥”坐那儿了，正郁闷，打完饭，发现那个位置是空着的，又欣喜若狂，其实刚刚那个“帅哥”只是临时过去打个招呼。</p>
<table>
<thead>
<tr>
<th><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql41.png" alt="mysql"><br />客户端A却读取到B未提交的脏数据</th>
<th><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql42.png" alt="mysql"><br />客户端B还未提交</th>
</tr>
</thead>
<tbody><tr>
<td><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql43.png" alt="mysql"><br />客户端A读取不到B未提交的脏数据</td>
<td><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql42.png" alt="mysql"><br />客户端B还未提交</td>
</tr>
</tbody></table>
<h3 id="不可重复读"><a href="#不可重复读" class="headerlink" title="不可重复读"></a>不可重复读</h3><p>不可重复读：在图书馆门口，发现自己占的位置旁边有位“美女”，等刷完卡，兴冲冲的走到那儿，发现已经变成一“如花”了。</p>
<table>
<thead>
<tr>
<th><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql44.png" alt="mysql"><br />A客户端在同一个事务中，前后两次读取同一条记录，值不同</th>
<th><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql45.png" alt="mysql"><br />B客户端提交了新修改的数据</th>
</tr>
</thead>
<tbody><tr>
<td><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql46.png" alt="mysql"><br />A客户端在同一个事务中，前后两次读取同一条记录，值相同</td>
<td><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql47.png" alt="mysql"><br />B客户端提交了新修改的数据</td>
</tr>
</tbody></table>
<h3 id="幻读"><a href="#幻读" class="headerlink" title="幻读"></a>幻读</h3><p>大学考前画重点，老师说“第一章 xxxxxx概念”，你赶紧找，“天啊，在哪儿啊”，等你画完，就听老师说：“第四章xxxxx”，中间那些你都没听到。</p>
<table>
<thead>
<tr>
<th><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql48.png" alt="mysql"><br />A客户端在同一个事务中，对同一个表的查询记录数不相同</th>
<th><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql49.png" alt="mysql"><br />B客户端事务删除了数据，并提交</th>
</tr>
</thead>
<tbody><tr>
<td><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql50.png" alt="mysql"><br />A客户端在同一个事务中，对同一个表的查询记录数不相同</td>
<td><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql51.png" alt="mysql"><br />B客户端事务添加了数据，并提交</td>
</tr>
</tbody></table>
<h3 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h3><table>
<thead>
<tr>
<th><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql52.png" alt="mysql"><br />A客户端的事务级别是序列化，A客户端正在查看temp表</th>
<th><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql53.png" alt="mysql"><br />B客户端想要多temp进行增、删、改操作不被允许如果A客户端迟迟不结束事务，B客户端将会报ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql54.png" alt="mysql"></td>
</tr>
<tr>
<td></td>
<td><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql55.png" alt="mysql"></td>
</tr>
<tr>
<td></td>
<td><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql56.png" alt="mysql"><br />但是B客户端对A客户端未涉及的表不受影响</td>
</tr>
</tbody></table>
<h1 id="权限与安全"><a href="#权限与安全" class="headerlink" title="权限与安全"></a>权限与安全</h1><p>数据库的权限和数据库的安全是息息相关的，不当的权限设置可能会导致各种各样的安全隐患，操作系统的某些设置也会对MySQL的安全造成影响。</p>
<h2 id="权限系统的工作原理"><a href="#权限系统的工作原理" class="headerlink" title="权限系统的工作原理"></a>权限系统的工作原理</h2><p>MySQL的权限系统通过下面两个阶段进行认证：</p>
<ul>
<li><p>对连接到数据库的用户进行身份认证，以此来判断此用户是否属于合法的用户，合法的用户通过认证，不合法的用户拒绝连接</p>
</li>
<li><p>对通过认证的合法的用户则赋予相应的权限，用户可以在这些权限范围内对数据库做相应的操作</p>
</li>
</ul>
<h3 id="身份认证"><a href="#身份认证" class="headerlink" title="身份认证"></a>身份认证</h3><p>对于身份认证，MySQL是通过IP地址和用户名联合进行确认的，也就是说，同样的一个用户名如果来自不同的IP地址，则MySQL将其视为不同的用户。</p>
<p>例如MySQL安装后默认创建的用户root@localhost表示用户root只能从本地(localhost)进行连接才可以通过认证，此用户从其他任何主机对数据库进行的连接都将被拒绝，除非安装时选择了（Enable root access from remote machines），那创建的就是root@%用户，就表示可以从任意主机通过root用户进行连接。</p>
<h3 id="权限表的存取"><a href="#权限表的存取" class="headerlink" title="权限表的存取"></a>权限表的存取</h3><p>在权限存取的两个过程中，系统会用到”mysql”数据库中user和db、host这三个最重要的权限表。</p>
<p>user表中的权限是针对所有数据库的，db表存储了某个用户对一个数据库的权限，host表中存储了某个主机对数据库的操作权限，配合db表对给定主机上数据库级操作权限做更细致的控制；但是很少用，新版本已经取消了host表。</p>
<p>当用户进行连接时，权限表的存取过程有一些两个阶段：</p>
<ul>
<li>先从user表中的host、user和password这3个字段中判断连接的IP、用户名和密码是否存在与表中，如果存在，则通过身份验证，否则拒绝连接。</li>
<li>如果通过身份验证，则按照一些权限表的顺序得到数据库权限：user-&gt;db-&gt;tables_priv-&gt;columns_priv。在这几个权限表中，权限范围依次递减，全局权限覆盖局部权限。<ul>
<li>当用户通过权限认证，进行权限分配是时先检查全局权限表user，如果user中对应权限为Y，则此用户对所有数据库的权限都为Y，将不再检查db、tables_priv和columns_priv；如果为N，则到db表中检查此用户对应的具体数据库，并得到db中为Y的权限，如果db中相应权限为N，则检查tables_priv中此数据库对应的具体表，取得表中为Y的权限，如果tables_priv中相应的权限为N，则检查columns_priv中此表对应的具体列，取得列中为Y的权限。</li>
</ul>
</li>
</ul>
<h4 id="用户表user"><a href="#用户表user" class="headerlink" title="用户表user"></a>用户表user</h4><p>user表有39个字段。这些字段可以分为4类：</p>
<ul>
<li>用户列：host，user，password三个字段</li>
<li>安全列：ssl_type、ssl_cipher、x509_issuer、x509_subject<ul>
<li>ssl用于加密；x509标准可以用来标识用户。普通的发行版都没有加密功能。可以使用SHOW VARIABLES LIKE ‘have_openssl’语句来查看是否具有ssl功能。如果取值为DISABLED，那么则没有ssl加密功能。</li>
</ul>
</li>
<li>资源控制列：max_questions（每小时可以允许执行多少次查询）、max_updates（每小时可以允许执行多少次更新）、max_connections（每小时可以建立多少连接）、max_user_connections（单个用户可以同时具有的连接数）<ul>
<li>默认值为0，表示无限制。</li>
</ul>
</li>
<li>权限列：<ul>
<li>这些字段的值只有Y和N。Y表示该权限可以用到所有数据库上；N表示该权限不能用到所有数据库上；通常，可以使用GRANT语句Wie用户赋予一些权限，也可以通过Update语句更新user表的方式来设置权限；不过，修改user表之后，一定要执行一下FLUSH PRIVILEGES</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>列</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Select_priv</td>
<td>确定用户是否可以通过SELECT命令选择数据</td>
</tr>
<tr>
<td>Insert_priv</td>
<td>确定用户是否可以通过INSERT命令插入数据</td>
</tr>
<tr>
<td>Update_priv</td>
<td>确定用户是否可以通过UPDATE命令修改现有数据</td>
</tr>
<tr>
<td>Delete_priv</td>
<td>确定用户是否可以通过DELETE命令删除现有数据</td>
</tr>
<tr>
<td>Create_priv</td>
<td>确定用户是否可以创建新的数据库和表</td>
</tr>
<tr>
<td>Drop_priv</td>
<td>确定用户是否可以删除现有数据库和表</td>
</tr>
<tr>
<td>Reload_priv</td>
<td>确定用户是否可以执行刷新和重新加载MySQL所用各种内部缓存的特定命令，包括日志、权限、主机、查询和表执行flush-hosts,flush-logs,flush-privileges,flush-status,flush-tables,flush-threads,refresh,reload等命令的而全新</td>
</tr>
<tr>
<td>Shutdown_priv</td>
<td>确定用户是否可以关闭MySQL服务器。在将此权限提供给root账户之外的任何用户时，都应当非常谨慎</td>
</tr>
<tr>
<td>Process_priv</td>
<td>确定用户是否可以通过SHOW PROCESSLIST命令查看其他用户的进程</td>
</tr>
<tr>
<td>File_priv</td>
<td>确定用户是否可以执行SELECT INTO OUTFILE和LOAD DATA INFILE命令，查看服务器主机上的文件</td>
</tr>
<tr>
<td>Grant_priv</td>
<td>确定用户是否可以将已经授予给该用户自己的权限再授予其他用户</td>
</tr>
<tr>
<td>References_priv</td>
<td>目前只是某些未来功能的占位符；现在没有作用</td>
</tr>
<tr>
<td>Index_priv</td>
<td>确定用户是否可以创建和删除表索引</td>
</tr>
<tr>
<td>Alter_priv</td>
<td>确定用户是否可以重命名和修改表结构</td>
</tr>
<tr>
<td>Show_db_priv</td>
<td>确定用户是否可以查看服务器上所有数据库的名字，包括用户拥有足够访问权限的数据库</td>
</tr>
<tr>
<td>Super_priv</td>
<td>确定用户是否可以执行某些强大的管理功能，例如通过KILL命令删除用户进程，使用SET GLOBAL修改全局MySQL变量，执行关于复制和日志的各种命令</td>
</tr>
<tr>
<td>Create_tmp_table_priv</td>
<td>确定用户是否可以创建临时表</td>
</tr>
<tr>
<td>Lock_tables_priv</td>
<td>确定用户是否可以使用LOCK TABLES命令阻止对表的访问/修改</td>
</tr>
<tr>
<td>Execute_priv</td>
<td>确定用户是否可以执行存储过程</td>
</tr>
<tr>
<td>Repl_slave_priv</td>
<td>确定用户是否可以读取用于维护复制数据库环境的二进制日志文件。此用户位于主系统中，有利于主机和客户机之间的通信</td>
</tr>
<tr>
<td>Repl_client_priv</td>
<td>确定用户是否可以确定复制从服务器和主服务器的位置</td>
</tr>
<tr>
<td>Create_view_priv</td>
<td>确定用户是否可以创建视图</td>
</tr>
<tr>
<td>Show_view_priv</td>
<td>确定用户是否可以查看视图或了解视图如何执行</td>
</tr>
<tr>
<td>Create_routine_priv</td>
<td>确定用户是否可以更改或放弃存储过程和函数</td>
</tr>
<tr>
<td>Alter_routine_priv</td>
<td>确定用户是否可以修改或删除存储函数及函数</td>
</tr>
<tr>
<td>Create_user_priv</td>
<td>确定用户是否可以执行CREATE USER命令，这个命令用于创建新的MySQL账户</td>
</tr>
<tr>
<td>Event_priv</td>
<td>确定用户能否创建、修改和删除事件</td>
</tr>
<tr>
<td>Trigger_priv</td>
<td>确定用户能否创建和删除触发器</td>
</tr>
</tbody></table>
<p>其他几个db、host、tables_priv、columns_priv权限表类似，可以通过desc查看字段</p>
<h2 id="账号管理"><a href="#账号管理" class="headerlink" title="账号管理"></a>账号管理</h2><h3 id="创建或更改账号"><a href="#创建或更改账号" class="headerlink" title="创建或更改账号"></a>创建或更改账号</h3><h4 id="语句命令方式"><a href="#语句命令方式" class="headerlink" title="语句命令方式"></a>语句命令方式</h4><p>有两种方法：</p>
<ol>
<li><p>使用GRANT语法创建（推荐）</p>
</li>
<li><p>直接insert，update权限表</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GRANT 权限类型列表 </span><br><span class="line">on  object_type &#123;表名称|*|*.*|db_name.*&#125;</span><br><span class="line"> to user [identified by password ‘密码’][,user [identified by password ‘密码’] ....</span><br><span class="line">with grant option;</span><br><span class="line">其中：object_type &#x3D; TABLE | FUNCTION | PROCEDURE</span><br></pre></td></tr></table></figure>

<p>例1：创建用户admin，权限为可以在所有数据库上执行所有权限，但只能从本地进行连接</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GRANT ALL PRIVILEGES ON *.* TO admin@localhost;</span><br></pre></td></tr></table></figure>

<p>可以发现除了Grant_priv权限外，所有权限在user表里面都是Y.</p>
<p>例2：在例1基础上，增加对admin的grant权限</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GRANT ALL PRIVILEGES ON *.* TO admin@localhost WITH GRANT OPTION;</span><br></pre></td></tr></table></figure>

<p>例3：在例2基础上，设置密码为“123”</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GRANT ALL PRIVILEGES ON *.* TO admin@localhost IDENTIFIED BY &#39;123&#39; WITH GRANT OPTION;</span><br></pre></td></tr></table></figure>

<p>例4：创建新用户chai，可以从任何IP进行连接，权限为对test数据库的所有表进行SELECT、UPDATE、INSERT、DELETE操作，初始密码为“123”</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GRANT SELECT,INSERT,UPDATE,DELETE ON test.* TO &#39;chai&#39;@&#39;%&#39; IDENTIFIED BY &#39;123&#39;;</span><br></pre></td></tr></table></figure>

<p>发现此例，user表中权限都是N，db表中增加的记录权限则都是Y。</p>
<p><strong>注意：</strong></p>
<ul>
<li>mysql数据库的user表中user的值为空，表示所有用户都可以连接（此处不能用<em>，</em>表示用户名为*的用户了）</li>
<li>mysql数据库的user表中host的值为*或空，表示所有外部IP都可以连接，但是不包括本地服务器localhost，因此如果要包括本地服务器，必须单独为localhost赋予权限。如果host的值为%，表示所有IP，包括本地服务器localhost。</li>
</ul>
<table>
<thead>
<tr>
<th>Host值</th>
<th>User值</th>
<th>被条目匹配的连接</th>
</tr>
</thead>
<tbody><tr>
<td>‘thomas.loc.gov’</td>
<td>‘fred’</td>
<td>fred，从thomas.loc.gov连接</td>
</tr>
<tr>
<td>‘thomas.loc.gov’</td>
<td>‘’</td>
<td>任何用户，从thomas.loc.gov连接</td>
</tr>
<tr>
<td>‘%’</td>
<td>‘fred’</td>
<td>fred，从任何主机连接</td>
</tr>
<tr>
<td>‘%’</td>
<td>‘’</td>
<td>任何用户，从任何主机连接</td>
</tr>
<tr>
<td>‘%.loc.gov’</td>
<td>‘fred’</td>
<td>fred，从在loc.gov域的任何主机连接</td>
</tr>
<tr>
<td>‘x.y.%’</td>
<td>‘fred’</td>
<td>fred，从在x.y.net，x.y.com等主机连</td>
</tr>
<tr>
<td>‘144.155.166.177’</td>
<td>‘fred’</td>
<td>fred，从144.155.166.177的IP地址连接</td>
</tr>
<tr>
<td>‘144.155.166.%’</td>
<td>‘fred’</td>
<td>fred，从‘144.155.166.*的C类子网的任何主机连接</td>
</tr>
</tbody></table>
<p>如果有多个匹配，服务器必须选择使用哪个条目，按照下述原则来解决：</p>
<ul>
<li>服务器在启动时读入user表后进行排序<ul>
<li>首先以最具体的host值排序，%排后面，如果host相同，以最具体的user值排序，空User值排后面。</li>
</ul>
</li>
<li>服务器使用与客户端和用户名匹配的第一行</li>
</ul>
<h4 id="navicat图形化界面"><a href="#navicat图形化界面" class="headerlink" title="navicat图形化界面"></a>navicat图形化界面</h4><p>1、新建用户</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql57.png" alt="mysql"></p>
<p>2、填写用户名、主机和密码</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql58.png" alt="mysql"></p>
<p>3、配use表的安全列和资源权限列的信息(0表示不限制)</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql59.png" alt="mysql"></p>
<p>4、选择user表的权限，这是针对所有数据库的全局权限</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql60.png" alt="mysql"></p>
<p>5、也可以设置单独某个数据库或某个表，或某个列的权限</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql61.png" alt="mysql"></p>
<h4 id="SQLyog图形化界面"><a href="#SQLyog图形化界面" class="headerlink" title="SQLyog图形化界面"></a>SQLyog图形化界面</h4><p>1、新建用户</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql62.png" alt="mysql"></p>
<p>2、填写用户名密码和资源权限等</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql63.png" alt="mysql"></p>
<p>3、全局权限</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql64.png" alt="mysql"></p>
<p>4、某个库或某个表等局部权限</p>
<p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/mysql65.png" alt="mysql"></p>
<h3 id="查看账户权限"><a href="#查看账户权限" class="headerlink" title="查看账户权限"></a>查看账户权限</h3><ul>
<li>show grants for user@host;</li>
</ul>
<h3 id="删除用户"><a href="#删除用户" class="headerlink" title="删除用户"></a>删除用户</h3><ul>
<li>drop user 用户名;</li>
</ul>
<h1 id="经典问题"><a href="#经典问题" class="headerlink" title="经典问题"></a>经典问题</h1><ol>
<li><p>在命令行出现乱码问题</p>
<p>按照数据库时选择utf8, 而我们在windows下窗口是GBK的,因此,需要在命令行客户端声明字符集.</p>
<p>set names gbk;是为了告诉服务器,客户端用的GBK编码,防止乱码.</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; set names gbk;  </span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>​        可以查看字符集</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; show variables like &#39;character_set_%&#39;;</span><br></pre></td></tr></table></figure>



<ol start="2">
<li><p>退出当前错误语句</p>
<p>语句打错以后应该退出本语句,再继续打新语句.</p>
<p>也可以打\c,快速退出本语句.</p>
</li>
<li><p>如何破解数据库的密码？安全模式登录</p>
</li>
</ol>
<ul>
<li><p>通过任务管理器或者服务管理,关掉mysqld(服务进程)</p>
</li>
<li><p>通过命令行+特殊参数开启mysqld</p>
<p>mysqld –skip-grant-tables</p>
</li>
<li><p>此时,mysqld服务进程已经打开,并且,不需要权限检查.</p>
</li>
<li><p>mysql -uroot  无密码登陆服务器.</p>
</li>
<li><p>修改权限表</p>
<ul>
<li>use mysql;</li>
<li>update user set Password = password(‘123456’) where User = ‘root’;</li>
<li>flush privileges;</li>
</ul>
</li>
<li><p>通过任务管理器,关掉mysqld服务进程.</p>
</li>
<li><p>再次通过服务管理,打mysql服务。</p>
</li>
<li><p>即可用修改后的新密码登陆.</p>
</li>
</ul>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Uncle He</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.unclehe.net/2020/06/29/java-mysql/">https://www.unclehe.net/2020/06/29/java-mysql/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.unclehe.net" target="_blank">Uncle He</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/cover/java.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/wechat.jpg" alt="wechat"/><div class="post-qr-code__desc">wechat</div></li><li class="reward-item"><img class="post-qr-code__img" src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/alipay.jpg" alt="alipay"/><div class="post-qr-code__desc">alipay</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/07/03/java-jdbc/"><img class="prev_cover" data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/cover/java.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">JDBC</div></div></a></div><div class="next-post pull_right"><a href="/2020/06/28/java-design-pattern/"><img class="next_cover" data-src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/cover/java.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">设计模式</div></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var requestSetting = function (from,set) {
  var from = from
  var setting = set.split(',').filter(function(item){
  return from.indexOf(item) > -1
  });
  setting = setting.length == 0 ? from :setting;
  return setting
}

var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
var requiredFields = requestSetting(['nick','mail','link'],'nick,mail')

window.valine = new Valine({
  el:'#vcomment',
  appId: 'kJLrzEh54hbM7O4kjF6VhlAt-MdYXbMMI',
  appKey: 'wbsLMRTmGNJ2wpVv2Xtvo17B',
  notify: false,
  verify: false,
  placeholder: '昵称请填写QQ号会自动获取头像和昵称...',
  avatar: 'monsterid',
  meta: guestInfo,
  pageSize: '10',
  lang: 'zh-CN',
  recordIP: false,
  serverURLs: '',
  emojiCDN: '',
  emojiMaps: "",
  enableQQ: true,
  requiredFields: requiredFields
});</script></div></article></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/img/cover/mysql.jpeg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By Uncle He</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://www.unclehe.net/">blog</a>!</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">简</a><i class="darkmode far fa-moon" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@3/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script src="/js/search/local-search.js"></script><script src="https://cdn.jsdelivr.net/gh/uncle-he/blog-resource/js/customjs.js"></script></body></html>